<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Jeremy&#39;s Note</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://jeremywu.info/"/>
  <updated>2019-03-11T14:12:32.000Z</updated>
  <id>https://jeremywu.info/</id>
  
  <author>
    <name>Jeremy Wu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Rust çš„ç±»å‹ç³»ç»Ÿ</title>
    <link href="https://jeremywu.info/2019/03/10/Rust%20%E7%9A%84%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F/"/>
    <id>https://jeremywu.info/2019/03/10/Rust çš„ç±»å‹ç³»ç»Ÿ/</id>
    <published>2019-03-10T15:20:00.000Z</published>
    <updated>2019-03-11T14:12:32.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>Rust</code> <code>ç±»å‹ç³»ç»Ÿ</code></p><h2 id="Rust-çš„ç±»å‹ç³»ç»Ÿ"><a href="#Rust-çš„ç±»å‹ç³»ç»Ÿ" class="headerlink" title="Rust çš„ç±»å‹ç³»ç»Ÿ"></a>Rust çš„ç±»å‹ç³»ç»Ÿ</h2><p>Rust æ˜¯ä¸€é—¨é™æ€ç¼–è¯‘ç±»çš„è¯­è¨€, ç±»å‹ç³»ç»Ÿçš„è®¾è®¡å¯ä»¥å¸®åŠ©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå†…å°±å°†â€å®¹æ˜“å‡ºé”™çš„ä»£ç â€æš´éœ²ç»™ç¼–å†™ç¨‹åºçš„äºº. Rust çš„ç±»å‹ç³»ç»Ÿçš„è®¾è®¡ç›®æ ‡æ˜¯:</p><ul><li>å®‰å…¨æ€§</li><li>æ•ˆç‡</li><li>ç®€æ´</li></ul><a id="more"></a><p>Rust çš„ç¼–è¯‘å™¨ä¹Ÿä¼šæ ¹æ®ç¨‹åºç¼–å†™è€…ç¼–å†™çš„ä»£ç è‡ªåŠ¨æ¨æ–­å˜é‡çš„ç±»å‹, æ­£å› å¦‚æ­¤, Rust çš„ç¨‹åºå¯ä»¥å˜å¾—æ›´åŠ å¹²å‡€. å½“ç„¶, å¹¶ä¸èƒ½è¿‡åˆ†ä¾é è¿™ä¸ªæ¨æ–­ç³»ç»Ÿ, å› ä¸ºè¯¥æŠ¥é”™çš„åœ°æ–¹, ç¼–è¯‘å™¨ä¾æ—§ä¼šæ¯«ä¸ç•™æƒ…åœ°æŠ¥é”™.</p><p>å…³äºè‡ªåŠ¨æ¨æ–­ç±»å‹å¯ä»¥çœ‹è¿™ä¸ªä¾‹å­:<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»£ç æ‘˜æŠ„è‡ª Programming Rust ä¸€ä¹¦</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">build_vector</span></span>() -&gt; <span class="built_in">Vec</span>&lt;<span class="built_in">i16</span>&gt; &#123; <span class="comment">//&lt;-- æ³¨æ„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">// let mut v: Vec&lt;i16&gt; = Vec::&lt;i16&gt;::new();</span></span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut</span> v = <span class="built_in">Vec</span>::new();</span><br><span class="line"><span class="comment">// v.push(10i16);</span></span><br><span class="line"><span class="comment">// v.push(20i16);</span></span><br><span class="line">  v.push(<span class="number">10</span>);</span><br><span class="line">  v.push(<span class="number">20</span>);</span><br><span class="line">  v</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢è¿™ä¸ªä¾‹å­, ç”±äºå‡½æ•°çš„è¿”å›æ˜¯ <code>v</code>, è€Œè¿”å›å€¼çš„ç±»å‹æ˜¯ <code>Vec&lt;i16&gt;</code>, é‚£ä¹ˆè‡ªç„¶ <code>v</code> ä¼šè¢«æ¨æ–­ä¸º <code>Vec&lt;i16&gt;</code> ç±»å‹. æ‰€ä»¥ <code>v.push(item)</code>, <code>item</code> çš„ç±»å‹è‡ªç„¶æ˜¯ <code>i16</code>. æ¯”è¾ƒæ³¨é‡Šå¤„çš„ä»£ç ä¼šæ˜¾å¾—æ›´åŠ ç®€æ´.</p><h3 id="Rust-çš„ç±»å‹ç§ç±»"><a href="#Rust-çš„ç±»å‹ç§ç±»" class="headerlink" title="Rust çš„ç±»å‹ç§ç±»"></a>Rust çš„ç±»å‹ç§ç±»</h3><h4 id="åŸºç¡€ç±»å‹"><a href="#åŸºç¡€ç±»å‹" class="headerlink" title="åŸºç¡€ç±»å‹"></a>åŸºç¡€ç±»å‹</h4><table><thead><tr><th style="text-align:center">å†…å­˜å¤§å° (bits)</th><th style="text-align:center">æ— ç¬¦å·æ•´æ•°</th><th style="text-align:center">æœ‰ç¬¦å·æ•´æ•°</th><th style="text-align:center">æµ®ç‚¹æ•°</th></tr></thead><tbody><tr><td style="text-align:center">8</td><td style="text-align:center">u8</td><td style="text-align:center">i8</td><td style="text-align:center">- </td></tr><tr><td style="text-align:center">16</td><td style="text-align:center">u16</td><td style="text-align:center">i16</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">32</td><td style="text-align:center">u32</td><td style="text-align:center">i32</td><td style="text-align:center">f32    </td></tr><tr><td style="text-align:center">64</td><td style="text-align:center">u64</td><td style="text-align:center">i64</td><td style="text-align:center">f64</td></tr><tr><td style="text-align:center">æœºå™¨å­—é•¿</td><td style="text-align:center">usize</td><td style="text-align:center">isize</td><td style="text-align:center">-</td></tr></tbody></table><p>æ³¨: æœºå™¨å­—é•¿æ ¹æ® OS æ”¯æŒçš„ä½æ•°æ¥è‡ªé€‚åº”çš„, å¦‚æœä½ çš„ä»£ç è·‘åœ¨ 32 bit çš„æœºå™¨ä¸Š, é‚£ä¹ˆæœºå™¨å­—é•¿å°±åº”è¯¥ä¸º 32bit, å¯¹åº”çš„ <code>uszie</code> å°±æ˜¯ 32 ä½, ä½†æ˜¯è¦æ³¨æ„å³ä½¿åœ¨ 32 ä½çš„ç”µè„‘ä¸Š, å†…å­˜é‡Œçš„ <code>usize</code> å’Œ <code>u32</code> çš„å†…å­˜è¡¨ç¤ºæ˜¯ä¸€æ ·çš„, ä½† <code>usize</code> != <code>u32</code>, åœ¨æ‰§è¡Œç‰¹å®šæ“ä½œæ—¶, éœ€è¦å°† <code>usize</code> é€šè¿‡ <code>usize as u32</code> å¼ºè½¬æˆ <code>u32</code> ç±»å‹.</p><ul><li><strong>æ— ç¬¦å·æ•´æ•°</strong>æ¯ä¸€ä½éƒ½ç”¨æ¥è¡¨ç¤ºå®ƒçš„å¤§å°. èŒƒå›´ä» 0 - 2<sup>size</sup>-1.</li><li><strong>ç¬¦å·æ•´æ•°</strong>åœ¨ Rust ä¸­ç”¨ <a href="https://zh.wikipedia.org/wiki/%E6%9C%89%E7%AC%A6%E8%99%9F%E6%95%B8%E8%99%95%E7%90%86" target="_blank" rel="noopener">2 çš„è¡¥ç </a>æ¥è¡¨ç¤º, å› æ­¤ä¹Ÿæ²¡æœ‰ Â±0 çš„é—®é¢˜å­˜åœ¨. èƒ½å¤Ÿè¡¨ç¤ºçš„èŒƒå›´ä¸º [2<sup>size - 1</sup>, 2 <sup>size - 1</sup> -1]</li><li><p><strong>æµ®ç‚¹æ•°</strong>åœ¨ Rust ä¸­çš„è¡¨ç¤ºéµå¾ªäº† <a href="https://zh.wikipedia.org/wiki/IEEE_754" target="_blank" rel="noopener">IEEE 754-2008</a> çš„å•ç²¾åº¦å’ŒåŒç²¾åº¦æµ®ç‚¹æ•°æ ‡å‡†.</p></li><li><p><strong>å­—ç¬¦ç±»å‹</strong>åœ¨ Rust ä¸­è¡¨ç¤ºå•ä¸ªæœ‰æ•ˆçš„ <code>Unicode</code> å­—ç¬¦, é•¿åº¦ä¸º 32-bit, <code>char</code> åªèƒ½ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„ Unicode å­—ç¬¦, ä»¥ <code>&#39;ç‹¬&#39;</code> å½¢å¼, ä¸ <code>str</code> ç±»å‹ä¸åŒåœ¨äº, <code>char</code> è¡¨ç¤ºçš„å­—ç¬¦è¦ç”¨ å•å¼•å· (<code>&#39;</code>) æ¥ä¿®é¥°, è€Œ <code>str</code> ç±»å‹ä½¿ç”¨åŒå¼•å·(<code>&quot;</code>)ä¿®é¥°, ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>&#39;\u{007F}&#39;</code> çš„æ–¹å¼æ¥è¡¨ç¤ºä¸€ä¸ª <code>char</code> ç±»å‹.</p></li><li><p><strong>å¸ƒå°”ç±»å‹</strong>åœ¨ Rust ä¸­ç”¨ <code>true</code> å’Œ <code>false</code> è¡¨ç¤º, åœ¨å†…å­˜ä¸­è¡¨ç¤ºä¸ºä¸€ä¸ªå®Œæ•´çš„å­—èŠ‚ (8-bit), æ‰€ä»¥ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ”¹åœ°å€çš„æŒ‡é’ˆ.</p></li></ul><h5 id="æœ€å¤§çš„æ•°"><a href="#æœ€å¤§çš„æ•°" class="headerlink" title="æœ€å¤§çš„æ•°"></a>æœ€å¤§çš„æ•°</h5><p>Rust ä¸­ç®—æ•°è¿ç®—å¦‚æœå‘ç”Ÿäº†ä½æº¢å‡ºä¼šè‡´ä½¿æ•´ä¸ªç¨‹åºå´©æºƒ, Rust èƒ½å¤Ÿè¡¨ç¤ºçš„æœ€å¤§çš„æœ‰ç¬¦å·æ•´æ•°å¯ä»¥åœ¨æ ‡å‡†åº“å¯¹åº”çš„ç±»å‹ä¸‹æˆå‘˜<code>std::itype::MAX</code> å¦‚ <code>std::i32::MAX</code>.</p><h5 id="Byte-ç±»å‹"><a href="#Byte-ç±»å‹" class="headerlink" title="Byte ç±»å‹"></a>Byte ç±»å‹</h5><p>å¯¹äºå¾ˆå¤šè¯­è¨€ä¸­å­˜åœ¨çš„ <code>byte</code> ç±»å‹, åœ¨ Rust ä¸­ç”¨ <code>u8</code> æ¥è¡¨ç¤º, å½“ä» socket å’Œ æ–‡ä»¶ä¸­è¯»å–æ•°æ®æ—¶, éƒ½ä¼šäº§å‡º <code>u8</code> ç±»å‹çš„å€¼.</p><h5 id="æ•´æ•°ç±»å‹çš„å­—é¢é‡è¡¨ç¤º"><a href="#æ•´æ•°ç±»å‹çš„å­—é¢é‡è¡¨ç¤º" class="headerlink" title="æ•´æ•°ç±»å‹çš„å­—é¢é‡è¡¨ç¤º"></a>æ•´æ•°ç±»å‹çš„å­—é¢é‡è¡¨ç¤º</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> suffix = <span class="number">245u8</span>;</span><br><span class="line"><span class="keyword">let</span> underscore = <span class="number">222_222u32</span>;</span><br><span class="line"><span class="keyword">let</span> bytes_literal = <span class="number">0b1111_1111</span>; <span class="comment">// u8</span></span><br><span class="line"><span class="keyword">let</span> float = <span class="number">0.5</span>; <span class="comment">// è‡ªåŠ¨æ¨æ–­ä¸ºf64.</span></span><br><span class="line"><span class="keyword">let</span> octal = <span class="number">0o53</span>;</span><br></pre></td></tr></table></figure><p>Rust è¿˜æä¾›äº†ä¸€ç§æ–¹å¼èƒ½å¤Ÿæ–¹ä¾¿çš„å°† <a href="https://zh.wikipedia.org/wiki/ASCII" target="_blank" rel="noopener">ASCII</a> è½¬æ¢æˆ <code>u8</code> ç±»å‹çš„å†™æ³•<br><code>let ascii = b&#39;ASCII&#39;;</code>, è¿™æ ·å¯ä»¥æ–¹ä¾¿å¿«æ·åœ°æŠŠ ASCII Code è½¬æ¢æˆä¸€è¿ä¸²çš„äºŒè¿›åˆ¶æ•°.</p><h5 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h5><p>Rust ä¹Ÿåƒ Go, Java è¿™æ ·çš„è¯­è¨€ä¸€æ ·, æä¾›äº†ç±»å‹ä¹‹é—´çš„è½¬æ¢çš„æ–¹æ³•, ä¸è¿‡å…³äº Rust ä¸­çš„ç±»å‹è½¬æ¢, æ­¤å¤„ä¸åšé‡ç‚¹ä»‹ç», ä¼šä¸“é—¨ç•™ä¸€å°èŠ‚æ¥åšé‡ç‚¹ä»‹ç». ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯, ä¸ C, C++ ç­‰è¯­è¨€ä¸åŒçš„åœ°æ–¹æ˜¯, Rust ä¸ä¼šå¯¹å€¼æ“ä½œæ—¶è¿›è¡Œéšå¼è½¬æ¢, å¦‚ç±»å‹ä¸º <code>i32</code> å’Œ <code>i64</code> çš„ä¸¤ä¸ªå˜é‡è¿›è¡Œæ¯”è¾ƒæ—¶, å°½ç®¡ <code>i32</code> çš„å€¼æ°¸è¿œéƒ½æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ <code>i64</code> çš„å€¼, ä½†å› ä¸ºç±»å‹ä¸åŒ, ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æœŸå°±æŠ›é”™.</p><h4 id="æ•°ç»„ç±»å‹"><a href="#æ•°ç»„ç±»å‹" class="headerlink" title="æ•°ç»„ç±»å‹"></a>æ•°ç»„ç±»å‹</h4><p>æ•°ç»„åœ¨ Rust ä¸­çš„è¡¨ç¤ºä¸º <code>[T;N]</code>, ä»£è¡¨ä¸€ä¸ªå«æœ‰ N ä¸ª <code>T</code> ç±»å‹çš„é›†åˆ, åœ¨ Rust ä¸­æ•°ç»„æ˜¯ä¸€ä¸ª<strong>å›ºå®šå¤§å°</strong>çš„ä¸€ä¸ªç±»å‹, å®ƒåœ¨ç¼–è¯‘æœŸå°±å¯ä»¥åˆ¤å®šæ‰€éœ€è¦å†…å­˜ç©ºé—´çš„å¤§å°: <code>N * size(T)</code>. æ•°ç»„ä¸èƒ½å¤Ÿæ·»åŠ å’Œåˆ é™¤æˆå‘˜, ä½†å¯ä»¥æ”¹å˜æˆå‘˜. æ•°ç»„æˆå‘˜è¢«ä¿å­˜åœ¨æ ˆå†…å­˜ä¸­.<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">20u8</span>;<span class="number">40</span>]; <span class="comment">// æ‹¥æœ‰ 40 ä¸ª å€¼ä¸º 20 çš„æ•°ç»„</span></span><br><span class="line">a.push(<span class="number">20u8</span>); <span class="comment">// no method named `push` found for type `[u8; 40]` in the current scope</span></span><br></pre></td></tr></table></figure></p><h4 id="åŠ¨æ€æ•°ç»„ç±»å‹"><a href="#åŠ¨æ€æ•°ç»„ç±»å‹" class="headerlink" title="åŠ¨æ€æ•°ç»„ç±»å‹"></a>åŠ¨æ€æ•°ç»„ç±»å‹</h4><p>åŠ¨æ€æ•°ç»„ç±»å‹æ˜¯æ ¹æ•°ç»„æœ‰ç€åŒæ ·ä½œç”¨ä½†å†…å­˜æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†é…çš„, å¹¶ä¸”å¯ä»¥åŠ¨æ€æ·»åŠ , åˆ é™¤æˆå‘˜æ•°ç»„, æ›´æ”¹æ•°ç»„çš„å®¹é‡å¤§å°. åŠ¨æ€æ•°ç»„çš„æˆå‘˜è¢«ä¿å­˜åœ¨å †å†…å­˜ä¸­.</p><h4 id="åˆ‡ç‰‡ç±»å‹"><a href="#åˆ‡ç‰‡ç±»å‹" class="headerlink" title="åˆ‡ç‰‡ç±»å‹"></a>åˆ‡ç‰‡ç±»å‹</h4><p>åˆ‡ç‰‡ç±»å‹æ˜¯å¯¹æ•°ç»„æˆ–è€…åŠ¨æ€æ•°ç»„çš„ä¸€ä¸ªå¼•ç”¨, å†…å­˜ä¸­è¡¨ç°ä¸ºä¸€ä¸ªèƒ–æŒ‡é’ˆ (Fat Pointer), è¿™ä¸ªèƒ–æŒ‡é’ˆç»„æˆå¦‚è¡¨:<br>å­—æ®µå     |    æè¿°<br>â€”â€”â€”-|â€”â€”â€”â€”<br>pointer   | æŒ‡å‘åˆ‡ç‰‡ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ<br>number    | è¯¥åˆ‡ç‰‡æ‹¥æœ‰å¤šå°‘ä¸ªå…ƒç´ </p><h4 id="æ•°ç»„-åŠ¨æ€æ•°ç»„-åˆ‡ç‰‡çš„å†…å­˜æ¨¡å‹æ¯”è¾ƒ"><a href="#æ•°ç»„-åŠ¨æ€æ•°ç»„-åˆ‡ç‰‡çš„å†…å­˜æ¨¡å‹æ¯”è¾ƒ" class="headerlink" title="æ•°ç»„, åŠ¨æ€æ•°ç»„, åˆ‡ç‰‡çš„å†…å­˜æ¨¡å‹æ¯”è¾ƒ"></a>æ•°ç»„, åŠ¨æ€æ•°ç»„, åˆ‡ç‰‡çš„å†…å­˜æ¨¡å‹æ¯”è¾ƒ</h4><blockquote><p>å›¾ç‰‡æ¥è‡ªäº Programming Rust ä¸€ä¹¦</p></blockquote><h4 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h4><p>å­—ç¬¦ä¸²å¯ä»¥è¢«è§†ä¸ºä¸€è¿ä¸²çš„ <code>char</code> ç±»å‹çš„ç»„åˆ, å­—ç¬¦ä¸²æœ‰ä¸¤ç§ç±»å‹</p><ul><li>str (ä¸å¯å˜, å¯é€šè¿‡ç´¢å¼•è®¿é—®)</li><li>String (å¯å˜, ä¸å¯é€šè¿‡ç´¢å¼•è®¿é—®)</li></ul><h5 id="Stringåœ¨å†…å­˜ä¸­çš„è¡¨ç¤º"><a href="#Stringåœ¨å†…å­˜ä¸­çš„è¡¨ç¤º" class="headerlink" title="Stringåœ¨å†…å­˜ä¸­çš„è¡¨ç¤º"></a>Stringåœ¨å†…å­˜ä¸­çš„è¡¨ç¤º</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> noodles = <span class="string">"noodles"</span>.to_string();</span><br><span class="line"><span class="keyword">let</span> oodles = &amp;noodles[<span class="number">1</span>..];</span><br><span class="line"><span class="keyword">let</span> poodles = <span class="string">" _ "</span>;</span><br></pre></td></tr></table></figure><blockquote><p>% asset_img å­—ç¬¦ä¸²å†…å­˜æ¨¡å‹.jpg å­—ç¬¦ä¸²å†…å­˜æ¨¡å‹ %}</p><ul><li>ä»¥ä¸Šæ¥è‡ª Programming Rust ä¸€ä¹¦</li></ul></blockquote><p>String åœ¨å†…å­˜ä¸­æ˜¯é€šè¿‡è¿è¡Œæ—¶åŠ¨æ€åˆ†é…åœ¨å †å†…å­˜ä¸Šçš„, ä½† <code>String</code> åœ¨å †å†…å­˜ä¸Šè¿˜æ˜¯éœ€è¦æœ‰å¯¹åº”çš„è¡¨ç¤ºçš„, å®é™…ä¸Š, <code>String</code> ç±»å‹åœ¨å †å†…å­˜ä¸Šçš„è¡¨ç¤º:</p><table><thead><tr><th>å­—æ®µå</th><th>æè¿°</th></tr></thead><tbody><tr><td>ptr</td><td>æŒ‡å‘å †å†…å­˜ä¸Šçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å†…å­˜åœ°å€</td></tr><tr><td>capacity</td><td>å½“å‰ <code>String</code> çš„å®¹é‡ </td></tr><tr><td>length</td><td>å½“å‰ <code>String</code> çš„é•¿åº¦</td></tr></tbody></table><p>åœ¨ Rust ä¸­, å­—ç¬¦ä¸²å­—é¢é‡å¦‚: â€œI am some stringâ€ çš„ç±»å‹ä¸º <code>&amp;str</code>, å¹¶ä¸”è¿™ä¸ªå˜é‡çš„ç”Ÿå‘½å‘¨æœŸå’Œç¨‹åºä¸€æ ·é•¿, å½“ç¨‹åºå¯åŠ¨æ—¶è¯¥å­—ç¬¦ä¸²å­—é¢é‡å°±è¢«åˆ›å»ºåœ¨å¸¸é‡æ± ä¸­, å½“ç¨‹åºç»“æŸäº†ä¹‹å, å¸¸é‡æ± é‡Œçš„è¯¥å˜é‡ä¹Ÿå¯¹åº”é”€æ¯. è€ŒåŠ¨æ€çš„ <code>String</code> ç”¨æ¥ä¿å­˜ä¸€äº›åŠ¨æ€æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸå¹¶ä¸è·Ÿå­—ç¬¦ä¸²å­—é¢é‡ä¸€æ ·é•¿, è¿™äº›å†…å­˜è¢«åŠ¨æ€åˆ†é….</p><h3 id="æŒ‡é’ˆç±»å‹"><a href="#æŒ‡é’ˆç±»å‹" class="headerlink" title="æŒ‡é’ˆç±»å‹"></a>æŒ‡é’ˆç±»å‹</h3><p>Rust å’Œ C/C++ ä¸€æ ·, æ‹¥æœ‰æŒ‡é’ˆç±»å‹, ä¸è¿‡ Rust çš„æŒ‡é’ˆç±»å‹åˆ†ä¸ºå¼•ç”¨æŒ‡é’ˆå’Œè£¸æŒ‡é’ˆ.</p><h4 id="å¼•ç”¨æŒ‡é’ˆ"><a href="#å¼•ç”¨æŒ‡é’ˆ" class="headerlink" title="å¼•ç”¨æŒ‡é’ˆ"></a>å¼•ç”¨æŒ‡é’ˆ</h4><p>é€šè¿‡ <code>&amp;</code> æ“ä½œç¬¦å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆ, æŒ‡å‘å¯¹åº”çš„å˜é‡.<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">20u32</span>;</span><br><span class="line"><span class="keyword">let</span> ptr = &amp;a;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;:p&#125;"</span>, ptr); <span class="comment">// 0x7fff304b5774</span></span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯, è™½ç„¶è¿™æ ·å°±å¯ä»¥ç›´æ¥åˆ›å»ºæŒ‡é’ˆ, ä½†æ˜¯è¦ä¸Šä¾‹çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯æ ˆä¸­çš„å˜é‡è€Œä¸æ˜¯å †ä¸­çš„å˜é‡, å¾ˆå¤šæ—¶å€™ç”±äºæ ˆçš„ç©ºé—´æœ‰é™åˆ¶, ä¼šå€¾å‘äºé€‰æ‹©åœ¨å †ä¸Šåˆ›å»ºå˜é‡å¹¶å»ºç«‹æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªå˜é‡, å¦‚åŠ¨æ€æ•°ç»„, å­—ç¬¦ä¸²ä¸­ä¾¿æœ‰ä¸€ä¸ªä¿å­˜å½“å‰æŒ‡é’ˆçš„å­—æ®µ.</p><h4 id="ç›’ç±»å‹"><a href="#ç›’ç±»å‹" class="headerlink" title="ç›’ç±»å‹"></a>ç›’ç±»å‹</h4><p>é€šè¿‡ Rust æ ‡å‡†åº“ä¸­æä¾›çš„ <code>Box</code> ç±»å‹, å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨å †å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªå˜é‡, ç±»å‹ä¸º <code>Box&lt;T&gt;</code>.<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> heap = <span class="built_in">Box</span>::new(<span class="number">20u32</span>); <span class="comment">// Boxed value, è¿™æ ·å°±åœ¨å †ä¸Šåˆ›å»ºäº†ä¸€ä¸ª u32 ç±»å‹çš„å˜é‡</span></span><br></pre></td></tr></table></figure></p><h3 id="è£¸æŒ‡é’ˆ"><a href="#è£¸æŒ‡é’ˆ" class="headerlink" title="è£¸æŒ‡é’ˆ"></a>è£¸æŒ‡é’ˆ</h3><p>Rust ä¸­çš„è£¸æŒ‡é’ˆå°±å’Œ C/C++ ä¸­çš„æŒ‡é’ˆç±»å‹ä¸€æ ·, æ‹¥æœ‰åŒæ ·çš„åŠŸèƒ½. å¼ ç¿å› å¦‚æ­¤, é‡æŒ‡é’ˆç”±äºä¸å¯æ§, ä¹Ÿå¯èƒ½å‡ºç°ç©ºæŒ‡é’ˆçš„é—®é¢˜.</p><h3 id="å¤åˆç±»å‹"><a href="#å¤åˆç±»å‹" class="headerlink" title="å¤åˆç±»å‹"></a>å¤åˆç±»å‹</h3><h4 id="å…ƒç»„"><a href="#å…ƒç»„" class="headerlink" title="å…ƒç»„"></a>å…ƒç»„</h4><p>å…ƒç»„åœ¨ Rust ä¸­çš„ä½œç”¨å’Œè¡¨ç°è·Ÿå…¶ä»–è¯­è¨€å¦‚: Python ä¸­ä¸€æ ·, è¡¨ç¤ºä¸€ä¸ªæœ‰åºçš„â€æ•°ç»„â€, å’Œæ•°ç»„ä¸ä¸€æ ·, å…ƒç»„çš„æ¯ä¸€ä¸ªå…ƒç´ å¯ä»¥æ‹¥æœ‰ä¸åŒçš„ç±»å‹.<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tuple = (<span class="number">1u32</span>, <span class="number">2u32</span>, <span class="number">3u32</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;:?&#125;"</span>, tuple.<span class="number">0</span>); <span class="comment">// ç”¨ tuple.index æ–¹å¼æ¥è®¿é—®æˆå‘˜</span></span><br><span class="line"><span class="keyword">let</span> (a, b, c) = tuple; <span class="comment">// tuple ç±»çš„è§£æ„</span></span><br></pre></td></tr></table></figure></p><p>åœ¨å†…å­˜ä¸­è¡¨ç°ä¸ºä¸€æ®µè¿ç»­çš„ä¸åŒç±»å‹å†…å­˜çš„ç»„åˆ, å¯ä»¥é€šè¿‡å…ƒç´ çš„ä½ç½®æ¥è®¿é—®.<br>å¹¶ä¸” tuple å¯ä»¥é€šè¿‡è§£æ„æ¥å–å¾—é‡Œé¢çš„å…ƒç´ .</p><h4 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h4><p>ç»“æ„ä½“ (Struct) è·Ÿå…¶ä»– OOP ä¸­çš„ class æœ‰äº›ç›¸ä¼¼, ç”¨æ¥æè¿°ä¸€ç³»åˆ—ç±»å‹çš„ç»„åˆ, æŠŠè¿™äº›ç±»å‹èšåˆåœ¨ä¸€èµ·, ä¾¿æˆäº†ä¸€ä¸ªç»“æ„ä½“.<br>ç»“æ„ä½“å¯ä»¥å¤§è‡´åˆ’åˆ†ä¸ºä¸¤ç§, ä¸€ç§å°±æ˜¯æœ€æ™®é€šçš„ç»“æ„ä½“, ä¸€ç§æ˜¯å…ƒç»„ç±»ç»“æ„ä½“<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span> &#123;</span><br><span class="line">  x: <span class="built_in">u32</span>,</span><br><span class="line">  y: <span class="built_in">u32</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IPv4</span></span>(<span class="built_in">u8</span>, <span class="built_in">u8</span>, <span class="built_in">u8</span>, <span class="built_in">u8</span>);</span><br></pre></td></tr></table></figure></p><h4 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h4><p>Rust ä¸­çš„æšä¸¾ç±»å’Œ C ä¸­çš„æšä¸¾ç±»å¾ˆç›¸ä¼¼, å¹¶ä¸”æœ‰æ›´åŠ å¼ºå¤§çš„åŠŸèƒ½, Rust çš„æšä¸¾æˆå‘˜èƒ½å¤ŸåŒ…å«éœ€è¦çš„ä¿¡æ¯, å¹¶ä¸”è¿˜å¯ä»¥åœ¨æšä¸¾ç±»ä¸Šå®ç°æ–¹æ³•.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;Rust&lt;/code&gt; &lt;code&gt;ç±»å‹ç³»ç»Ÿ&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;Rust-çš„ç±»å‹ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#Rust-çš„ç±»å‹ç³»ç»Ÿ&quot; class=&quot;headerlink&quot; title=&quot;Rust çš„ç±»å‹ç³»ç»Ÿ&quot;&gt;&lt;/a&gt;Rust çš„ç±»å‹ç³»ç»Ÿ&lt;/h2&gt;&lt;p&gt;Rust æ˜¯ä¸€é—¨é™æ€ç¼–è¯‘ç±»çš„è¯­è¨€, ç±»å‹ç³»ç»Ÿçš„è®¾è®¡å¯ä»¥å¸®åŠ©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå†…å°±å°†â€å®¹æ˜“å‡ºé”™çš„ä»£ç â€æš´éœ²ç»™ç¼–å†™ç¨‹åºçš„äºº. Rust çš„ç±»å‹ç³»ç»Ÿçš„è®¾è®¡ç›®æ ‡æ˜¯:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®‰å…¨æ€§&lt;/li&gt;
&lt;li&gt;æ•ˆç‡&lt;/li&gt;
&lt;li&gt;ç®€æ´&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Rust lang" scheme="https://jeremywu.info/categories/Rust-lang/"/>
    
    
      <category term="Rust" scheme="https://jeremywu.info/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>Rust æ§åˆ¶æµ</title>
    <link href="https://jeremywu.info/2019/03/10/Rust%20%E6%8E%A7%E5%88%B6%E6%B5%81/"/>
    <id>https://jeremywu.info/2019/03/10/Rust æ§åˆ¶æµ/</id>
    <published>2019-03-10T15:20:00.000Z</published>
    <updated>2019-03-12T15:17:29.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>Rust</code> <code>æ§åˆ¶æµ</code></p><p>ä»£ç è·‘ä¸ä¸è·‘, è·‘äº†ä¹‹åçš„ç»“æœæ˜¯ä»€ä¹ˆ, éƒ½ä¾èµ–äºæ§åˆ¶æµ, Rust ä¸­çš„æ§åˆ¶æµåˆ†ä¸ºä¸¤å¤§ç±»</p><ul><li>åˆ¤æ–­</li><li>å¾ªç¯</li></ul><a id="more"></a><h3 id="åˆ¤æ–­è¡¨è¾¾å¼"><a href="#åˆ¤æ–­è¡¨è¾¾å¼" class="headerlink" title="åˆ¤æ–­è¡¨è¾¾å¼"></a>åˆ¤æ–­è¡¨è¾¾å¼</h3><h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><p>åœ¨ Rust ä¸­, <code>if</code> ä»å¥ä¸æ˜¯ä¸€ä¸ªå£°æ˜è¯­å¥, æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼, ä¸ Java/Javascript ä¸­çš„ if ä¸åŒ:<br>Rust ä¸­:<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> number = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">if</span> number &lt; <span class="number">10</span> &#123;</span><br><span class="line">  <span class="number">20</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Javascript ä¸­:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> number = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> a;</span><br><span class="line"><span class="keyword">if</span> (number &lt; <span class="number">10</span>) &#123;</span><br><span class="line">  a = <span class="number">20</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="if-let"><a href="#if-let" class="headerlink" title="if let"></a>if let</h4><p><code>if</code> ä»å¥è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åˆ†æ”¯ å°±æ˜¯ <code>if let</code>, å®é™…ä¸Šè¿™ä¸ªå†™æ³•æ˜¯å¯¹æ¥ä¸‹æ¥è¦è®²çš„ <code>match</code> çš„ä¸€ä¸ªç®€å†™<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="literal">Some</span>(<span class="string">"b"</span>);</span><br><span class="line"><span class="comment">// è¿™é‡Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªåŒ¹é…çš„è§£æ„, åœ¨ä¸‹é¢ä¼šè¯´åˆ°</span></span><br><span class="line"><span class="keyword">let</span> c = <span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(val) = a &#123;</span><br><span class="line">  <span class="string">"equal"</span> <span class="comment">// ä¸èƒ½æœ‰åˆ†å·, å› ä¸ºæ˜¯è¿”å›å€¼</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="string">"not equal"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><div class="tip"><br><p>1. Rust ä¸­çš„ <code>if</code> æ˜¯<strong>è¡¨è¾¾å¼</strong>è€Œä¸æ˜¯å£°æ˜è¯­å¥</p><br><p>2. Rust ä¸­çš„ <code>if</code> åæ¥ç»­çš„æ¡ä»¶åªèƒ½æ˜¯ <code>bool</code> ç±»å‹, è€Œä¸èƒ½åƒ <code>Javascript</code> ä¸€æ ·ä»»æ„ç±»å‹çš„å€¼éƒ½å¯ä»¥.</p><br></div><h3 id="match"><a href="#match" class="headerlink" title="match"></a>match</h3><p><code>match</code> <strong>è¡¨è¾¾å¼</strong>åœ¨ Rust ä¸­å°±åƒ Javascript ä¸­çš„ <code>switch</code> å£°æ˜ä¸€æ ·, ä½†åŠŸèƒ½è¿œæ¯” <code>switch</code> çš„åŠŸèƒ½å¼ºå¤§<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Coin</span></span> &#123;</span><br><span class="line">  Penny,</span><br><span class="line">  Nickel,</span><br><span class="line">  Dime,</span><br><span class="line">  Quarter,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> coin = Coin::Quater;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> money = <span class="keyword">match</span> coin &#123;</span><br><span class="line">    Coin::Penny =&gt; &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"Lucky penny!"</span>);</span><br><span class="line">        <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    Coin::Nickel =&gt; <span class="number">5</span>,</span><br><span class="line">    Coin::Dime =&gt; <span class="number">10</span>,</span><br><span class="line">    Coin::Quarter =&gt; <span class="number">25</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­æœ€å¸¸ç”¨çš„ç”¨æ³•å°±æ˜¯é…åˆ <code>Enum</code> ç±»å‹, å¸¦æœ‰æ•°æ®çš„æšä¸¾ç±»é€šè¿‡åŒ¹é…èƒ½å¤Ÿæ‹¿åˆ°æºå¸¦çš„æ•°æ®, æ¥æä¾›ä½¿ç”¨.</p><h3 id="å¾ªç¯ä½“"><a href="#å¾ªç¯ä½“" class="headerlink" title="å¾ªç¯ä½“"></a>å¾ªç¯ä½“</h3><p>Rust ä¸€å…±æä¾›äº†ä¸‰ç§å¾ªç¯çš„æ–¹å¼:</p><ul><li><code>loop</code></li><li><code>while</code></li><li><code>for</code></li></ul><h4 id="loop"><a href="#loop" class="headerlink" title="loop"></a>loop</h4><p>åœ¨ Rust ä¸­, æœ€å¸¸è§çš„å¾ªç¯æ–¹å¼å°±æ˜¯ <code>loop</code> è¯­å¥, é€šè¿‡ <code>loop</code> è¯­å¥äº§ç”Ÿå¾ªç¯, ç„¶ååœ¨å¾ªç¯ä½“ä¸­é€šè¿‡ <code>break</code>, <code>continue</code>, <code>return</code>, è¿™äº›å…³é”®å­—æ¥æ§åˆ¶å¾ªç¯æµ, æœ€åè¾¾åˆ°ç›®çš„. ä¸å‡ºæ„å¤–åœ°, <code>loop</code> ä¾ç„¶è¿˜æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼, å¹¶ä¸”æ˜¯èƒ½å¤Ÿè¿”å›å€¼çš„ _(:Ğ·ã‚âˆ )_.</p><ul><li><p>æœ€ç®€å•çš„å¾ªç¯</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">loop</span> &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">"æ— é™å¾ªç¯"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¸­æ–­çš„å¾ªç¯</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> final_sum = <span class="keyword">loop</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> sum &gt; <span class="number">10</span> &#123;</span><br><span class="line">    <span class="keyword">break</span> sum <span class="comment">// break è¿™æ®µå¾ªç¯ å¹¶è¿”å› sum</span></span><br><span class="line">  &#125;</span><br><span class="line">  sum += <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;:?&#125;"</span>, final_sum);</span><br></pre></td></tr></table></figure></li></ul><h4 id="while"><a href="#while" class="headerlink" title="while"></a>while</h4><p>å’Œ <code>loop</code> ç›¸æ¯”, å¦å¤–ä¸€ä¸ªç”¨å¾—æ¯”è¾ƒå¤šçš„å¾ªç¯è¯­å¥å°±æ˜¯ <code>while</code>, <code>while</code> æ¯”è¾ƒèµ· <code>loop</code> æ¥, æ˜æ˜¾çš„åŒºåˆ«å°±æ˜¯, <code>while</code> å¾ªç¯çš„æ¡ä»¶è¯­å¥å¤–ç½®å¹¶ä¸” <code>while</code> è¯­å¥æ²¡æœ‰è¿”å›å€¼(æˆ–è€…è¯´è¿”å›å€¼æ˜¯ä¸€ä¸ªç©ºå…ƒç»„<code>()</code>), å½“å¾ªç¯æ¡ä»¶ä¸æ»¡è¶³, å¾ªç¯å°±ç›´æ¥ç»“æŸ.</p><p>å’Œ <code>loop</code> ä¸€æ ·æ•ˆæœçš„å¾ªç¯<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">true</span> &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">"æˆ‘å’Œ loop ä¸€æ ·è€¶"</span>);</span><br><span class="line">  <span class="comment">// å¯ä»¥åœ¨å¾ªç¯ä½“ä¸­æ’å…¥ break return è¯­å¥ä½œä¸ºä¸­æ–­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¡ä»¶å¾ªç¯<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> counter = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> counter &lt; <span class="number">10</span> &#123;</span><br><span class="line">  counter += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="for"><a href="#for" class="headerlink" title="for"></a>for</h4><p><code>for</code> å¾ªç¯ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç‰¹æ®Š, åªèƒ½ç”¨åœ¨é‚£äº›å®ç°è¿‡ <code>iterator</code> ç‰¹æ€§çš„å¯¹è±¡ä¸Š, æ²¡æœ‰å®ç°è¿™ä¸ªç‰¹æ€§çš„å¯¹è±¡æ˜¯æ²¡æœ‰åŠæ³•ç”¨ <code>for</code> è¯­å¥è¡¨è¾¾çš„<br><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> <span class="number">1</span>..<span class="number">11</span> &#123; <span class="comment">// from..to äº§å‡ºä¸€ä¸ªåŒºé—´ä¸º [from, to) Range ç±»å‹çš„å¯¹è±¡, å®ç°äº† iterator </span></span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">"&#123;:?&#125;"</span>, item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸Šå°±æ˜¯ Rust ä¸­çš„æ§åˆ¶æµ, æ¯ä¸€ä¸ªéƒ½æä¾›äº†éå¸¸å¼ºå¤§çš„åŠŸèƒ½, å®é™…åº”ç”¨ä¸­æ ¹æ®ä¸åŒçš„åœºæ™¯åº”ç”¨, æ¥è¾¾åˆ°ä¸åŒçš„ç›®çš„.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;Rust&lt;/code&gt; &lt;code&gt;æ§åˆ¶æµ&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä»£ç è·‘ä¸ä¸è·‘, è·‘äº†ä¹‹åçš„ç»“æœæ˜¯ä»€ä¹ˆ, éƒ½ä¾èµ–äºæ§åˆ¶æµ, Rust ä¸­çš„æ§åˆ¶æµåˆ†ä¸ºä¸¤å¤§ç±»&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ¤æ–­&lt;/li&gt;
&lt;li&gt;å¾ªç¯&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Rust lang" scheme="https://jeremywu.info/categories/Rust-lang/"/>
    
    
      <category term="Rust" scheme="https://jeremywu.info/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ—-Â§2.3-äº‹åŠ¡æœºåˆ¶</title>
    <link href="https://jeremywu.info/2018/08/06/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A72.3-%E4%BA%8B%E5%8A%A1%E6%9C%BA%E5%88%B6/"/>
    <id>https://jeremywu.info/2018/08/06/Reactæºç é˜…è¯»ç³»åˆ—-Â§2.3-äº‹åŠ¡æœºåˆ¶/</id>
    <published>2018-08-06T13:13:20.000Z</published>
    <updated>2018-08-06T15:58:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>transaction</code> <code>batch operation</code></p><h3 id="äº‹åŠ¡-Transaction-çš„åŸç†"><a href="#äº‹åŠ¡-Transaction-çš„åŸç†" class="headerlink" title="äº‹åŠ¡(Transaction)çš„åŸç†"></a>äº‹åŠ¡(Transaction)çš„åŸç†</h3><p>åœ¨å‰é¢æœ‰å‡ èŠ‚ä¸­åå¤æåˆ°äº†Reactçš„äº‹åŠ¡æœºåˆ¶(Transaction), ä»Šå¤©å°±å‡†å¤‡æ¥è®²ä¸€è®²è¿™ä¸ªäº‹åŠ¡æœºåˆ¶åˆ°åº•æ˜¯æ€ä¹ˆä¸ªä¸€å›äº‹.<br>ç”¨ä¸€å¥ç®€å•ä¸€ç‚¹çš„è¯æ¥å½¢å®¹è¿™ä¸ªä¸œè¥¿å°±æ˜¯: åœ¨è°ƒç”¨æŸä¸€ä¸ªå…·ä½“çš„æ–¹æ³•ä¹‹å‰ä¸ä¹‹å, å…ˆè°ƒç”¨ä¸€ç³»åˆ—çš„å¤„ç†å‡½æ•°, ç±»ä¼¼äº<code>npm install</code>å¯¹åº”çš„<code>npm preinstall</code>å’Œ<code>npm postinstall</code>, åˆ†åˆ«æ‰§è¡Œäº<code>npm install</code>è¿™ä¸ªè„šæœ¬çš„å¼€å§‹ä¹‹å‰ä¸å®Œæˆä¹‹å.</p><a id="more"></a><h4 id="ç”¨ä¸€å¹…å›¾æ¥è¯´æ˜"><a href="#ç”¨ä¸€å¹…å›¾æ¥è¯´æ˜" class="headerlink" title="ç”¨ä¸€å¹…å›¾æ¥è¯´æ˜:"></a>ç”¨ä¸€å¹…å›¾æ¥è¯´æ˜:</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *                       wrappers (injected at creation time)</span></span><br><span class="line"><span class="comment"> *                                      +        +</span></span><br><span class="line"><span class="comment"> *                                      |        |</span></span><br><span class="line"><span class="comment"> *                    +-----------------|--------|--------------+</span></span><br><span class="line"><span class="comment"> *                    |                 v        |              |</span></span><br><span class="line"><span class="comment"> *                    |      +---------------+   |              |</span></span><br><span class="line"><span class="comment"> *                    |   +--|    wrapper1   |---|----+         |</span></span><br><span class="line"><span class="comment"> *                    |   |  +---------------+   v    |         |</span></span><br><span class="line"><span class="comment"> *                    |   |          +-------------+  |         |</span></span><br><span class="line"><span class="comment"> *                    |   |     +----|   wrapper2  |--------+   |</span></span><br><span class="line"><span class="comment"> *                    |   |     |    +-------------+  |     |   |</span></span><br><span class="line"><span class="comment"> *                    |   |     |                     |     |   |</span></span><br><span class="line"><span class="comment"> *                    |   v     v                     v     v   | wrapper</span></span><br><span class="line"><span class="comment"> *                    | +---+ +---+   +---------+   +---+ +---+ | invariants</span></span><br><span class="line"><span class="comment"> * perform(anyMethod) | |   | |   |   |         |   |   | |   | | maintained</span></span><br><span class="line"><span class="comment"> * +-----------------&gt;|-|---|-|---|--&gt;|anyMethod|---|---|-|---|-|--------&gt;</span></span><br><span class="line"><span class="comment"> *                    | |   | |   |   |         |   |   | |   | |</span></span><br><span class="line"><span class="comment"> *                    | |   | |   |   |         |   |   | |   | |</span></span><br><span class="line"><span class="comment"> *                    | |   | |   |   |         |   |   | |   | |</span></span><br><span class="line"><span class="comment"> *                    | +---+ +---+   +---------+   +---+ +---+ |</span></span><br><span class="line"><span class="comment"> *                    |  initialize                    close    |</span></span><br><span class="line"><span class="comment"> *                    +-----------------------------------------+</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p><div class="tip"><br>è¯¥å›¾ç‰ˆæƒå±äºReactå¼€å‘å›¢é˜Ÿæ‰€æœ‰.</div></p><p><div><br>åœ¨æŸäº›æ¡†æ¶çš„æºç ä¸­å…¶å®ä¹Ÿä¾ç¨€å¯è§è¿™ç§å¤„ç†çš„æ€æƒ³, ç±»ä¼¼ä½†ä¸ä»…é™äºå¯¹<code>Array</code>çš„Nativeæ–¹æ³•çš„åŠ«æŒè°ƒç”¨, å¦‚<a href="https://vuejs.org/" target="_blank" rel="noopener">Vue</a>æ—©æœŸç‰ˆæœ¬å½“ä¸­å¯¹<code>Array</code>çš„å¤„ç†ç”¨æ¥æ·»åŠ å‡½æ•°å¤„ç†.</div></p><h4 id="äº‹åŠ¡ç±»çš„æ¥å£å®šä¹‰"><a href="#äº‹åŠ¡ç±»çš„æ¥å£å®šä¹‰" class="headerlink" title="äº‹åŠ¡ç±»çš„æ¥å£å®šä¹‰:"></a>äº‹åŠ¡ç±»çš„æ¥å£å®šä¹‰:</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> TransactionImpl = &#123;</span><br><span class="line">  reinireinitializeTransaction: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">void</span>; <span class="comment">// é‡ç½®wrapper</span></span><br><span class="line">  _isIntransaction: <span class="built_in">boolean</span>; <span class="comment">// transactionè°ƒåº¦æ—¶æ ‡è¯†ç¬¦</span></span><br><span class="line">  getTransactionWrappers: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">Array</span>&lt;TransactionWrapper&gt;; <span class="comment">// æ‹¿åˆ°æ‰€æœ‰wrapper</span></span><br><span class="line">  isInTransaction: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">boolean</span>; <span class="comment">// å¾—åˆ°_isIntransactionå±æ€§</span></span><br><span class="line">  perform: &lt;A, B, C, D, E, F, G, T: <span class="function">(<span class="params">a: A, b: B, c: C, d: D, e: E, f: F</span>) =&gt;</span> G&gt;</span><br><span class="line">    (method: T, scope: <span class="built_in">any</span>, a: A, b: B, c: C, d: D, e: E, f: F) =&gt; G; <span class="comment">// äº‹åŠ¡è°ƒåº¦ </span></span><br><span class="line">    <span class="comment">// åœ¨performæ–¹æ³•ä¸­å…ˆåè°ƒç”¨ this.initializeAll(index) å’Œ this.closeAll(index)</span></span><br><span class="line">  initializeAll: <span class="function">(<span class="params">startIndex: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span>; <span class="comment">// æ‰§è¡Œæ‰€æœ‰wrapperä¸­çš„initializeæ–¹æ³•</span></span><br><span class="line">  closeAll: <span class="function">(<span class="params">startIndex: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span>; <span class="comment">// æ‰§è¡Œæ‰€æœ‰wrapperä¸­çš„closeæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨Reactæ•´ä¸ªç³»ç»Ÿä¸­ä¸€å…±å®ç°äº†3ç§äº‹åŠ¡æ“ä½œç±»(æœåŠ¡ç«¯æ¸²æŸ“å’ŒReactNativeä¸ç®—).</p><ol><li>ReactUpdatesFlushTransaction</li><li>ReactBatchingStrategyTransaction</li><li>ReactReconcileTransaction</li></ol><p>æ¯ä¸€ç§äº‹åŠ¡ç±»éƒ½è´Ÿè´£å¤„ç†å¯¹åº”çš„æ“ä½œ(ä¸‹é¢ä¼šè¯´åˆ°).</p><p><code>ReactUpdates.batchedUpdates()</code>æ–¹æ³•è¢«ç”¨æ¥å¯åŠ¨æ•´ä¸ªæ›´æ–°çš„æ“ä½œ, ç„¶åæŠŠè¿™ä¸ªæ“ä½œçš„åˆ†é…å·¥ä½œäº¤ç»™<code>ReactBatchingUpdateStrategyTransaction</code></p><h4 id="ReactBatchingUpdateStrategyTransactionçš„Wrapperå®ç°ä»¥åŠåŠŸèƒ½"><a href="#ReactBatchingUpdateStrategyTransactionçš„Wrapperå®ç°ä»¥åŠåŠŸèƒ½" class="headerlink" title="ReactBatchingUpdateStrategyTransactionçš„Wrapperå®ç°ä»¥åŠåŠŸèƒ½:"></a>ReactBatchingUpdateStrategyTransactionçš„Wrapperå®ç°ä»¥åŠåŠŸèƒ½:</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> TransactionImpl <span class="keyword">from</span> <span class="string">'Transaction'</span>;</span><br><span class="line"><span class="comment">// å®šä¹‰Wrapper1å·</span></span><br><span class="line"><span class="keyword">var</span> RESET_BATCHED_UPDATES = &#123;</span><br><span class="line">  initialize: emptyFunction, <span class="comment">// ç©ºæ–¹æ³•</span></span><br><span class="line">  close: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æ ‡å¿—ä½ç½®å›false</span></span><br><span class="line">    ReactDefaultBatchingStrategy.isBatchingUpdates = <span class="literal">false</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// å®šä¹‰Wrapper2å·</span></span><br><span class="line"><span class="keyword">var</span> FLUSH_BATCHED_UPDATES = &#123;</span><br><span class="line">  initialize: emptyFunction, <span class="comment">// ç©ºæ–¹æ³•</span></span><br><span class="line">  <span class="comment">// æ›´æ–°DOM</span></span><br><span class="line">  close: ReactUpdates.flushBatchedUpdates.bind(ReactUpdates),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TRANSACTION_WRAPPERS: <span class="built_in">Array</span>&lt;TransactionWrapper&gt; = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å½“åœ¨è°ƒç”¨è¿™ä¸ªtransaction.performæ–¹æ³•çš„æ—¶å€™å®é™…ä¸Šæ˜¯è¿™æ ·çš„:</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *            +----------------------+    +---------------------+        +----------+</span></span><br><span class="line"><span class="comment"> * perform -&gt; |FLUSH_BATCHED_UPDATES.| -&gt; |REST_BATCHED_UPDATES.| -----&gt; |  method  |</span></span><br><span class="line"><span class="comment"> *            |      initialize      |    |      initialize     |        |          |</span></span><br><span class="line"><span class="comment"> *            +----------------------+    +---------------------+        +----------+</span></span><br><span class="line"><span class="comment"> *                                                                            |</span></span><br><span class="line"><span class="comment"> *            +----------------------+    +----------------------+            |</span></span><br><span class="line"><span class="comment"> *            |REST_BATCHED_UPDATES. |    |FLUSH_BATCHED_UPDATES.|            |</span></span><br><span class="line"><span class="comment"> *            |        close         |    |        close         | &lt;----------+</span></span><br><span class="line"><span class="comment"> *            +----------------------+    +----------------------+</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p><code>ReactUpdates.flushBatchedUpdates</code>è°ƒç”¨<code>ReactUpdatesFlushTransaction.perform(runBatchedUpdates)æ–¹æ³•</code>ğŸ‘‡.</p><h4 id="ReactUpdatesFlushTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½"><a href="#ReactUpdatesFlushTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½" class="headerlink" title="ReactUpdatesFlushTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½"></a>ReactUpdatesFlushTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Wrapper1å·å®šä¹‰</span></span><br><span class="line"><span class="keyword">var</span> NESTED_UPDATES = &#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.dirtyComponentsLength = dirtyComponents.length;</span><br><span class="line">  &#125;,</span><br><span class="line">  close: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.dirtyComponentsLength !== dirtyComponents.length) &#123;</span><br><span class="line">      <span class="comment">// å¤„ç†å½“ Açš„updateè¿‡ç¨‹ä¸­è°ƒç”¨äº†Bçš„setStateæ–¹æ³•çš„æƒ…å†µ</span></span><br><span class="line">      dirtyComponents.splice(<span class="number">0</span>, <span class="keyword">this</span>.dirtyComponentsLength);</span><br><span class="line">      flushBatchedUpdates();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      dirtyComponents.length = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// Wrapper2å·å®šä¹‰</span></span><br><span class="line"><span class="keyword">var</span> UPDATE_QUEUEING = &#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.callbackQueue.reset();</span><br><span class="line">  &#125;,</span><br><span class="line">  close: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.callbackQueue.notifyAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">ReactUpdatesFlushTransaction.prototype.perform = <span class="function"><span class="keyword">function</span> (<span class="params">method, scope, a</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è°ƒç”¨ReactReconcileTransactionå»è°ƒç”¨runBatchedUpdatesæ–¹æ³•</span></span><br><span class="line">  <span class="keyword">return</span> Transaction.perform.call(<span class="keyword">this</span>, <span class="keyword">this</span>.reconcileTransaction.perform, <span class="keyword">this</span>.reconcileTransaction, method, scope, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±åˆ°äº†æˆ‘ä»¬æ‰§è¡Œæ›´æ–°æ“ä½œçš„é‚£ä½é€‰æ‰‹<code>ReactReconcileTransaction</code></p><h4 id="ReactReconcileTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½"><a href="#ReactReconcileTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½" class="headerlink" title="ReactReconcileTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½"></a>ReactReconcileTransactionçš„å®ç°ä»¥åŠåŠŸèƒ½</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SELECTION_RESTORATION = &#123;</span><br><span class="line">  initialize: ReactInputSelection.getSelectionInformation,</span><br><span class="line">  close: ReactInputSelection.restoreSelection,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> EVENT_SUPPRESSION = &#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> currentlyEnabled = ReactBrowserEventEmitter.isEnabled();</span><br><span class="line">    ReactBrowserEventEmitter.setEnabled(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">return</span> currentlyEnabled;</span><br><span class="line">  &#125;,</span><br><span class="line">  close: <span class="function"><span class="keyword">function</span>(<span class="params">previouslyEnabled</span>) </span>&#123;</span><br><span class="line">    ReactBrowserEventEmitter.setEnabled(previouslyEnabled);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> ON_DOM_READY_QUEUEING = &#123;</span><br><span class="line">  initialize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.reactMountReady.reset();</span><br><span class="line">  &#125;,</span><br><span class="line">  close: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.reactMountReady.notifyAll();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> TRANSACTION_WRAPPERS = [</span><br><span class="line">  SELECTION_RESTORATION,</span><br><span class="line">  EVENT_SUPPRESSION,</span><br><span class="line">  ON_DOM_READY_QUEUEING,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p>è‡³æ­¤æ•´ä¸ªäº‹åŠ¡è°ƒç”¨ç»“æŸ ç”±batchingTransaction -&gt; FlushTransaction -&gt; ReconcileTransactionå»è°ƒç”¨äº†<code>ReactUpdates.runBatchedUpdates</code>æ–¹æ³•, ç„¶ååˆ†åˆ«å¤„ç†äº†<code>callback</code>, <code>DOMäº‹ä»¶</code>ç­‰ä¸€ç³»åˆ—äº‹åŠ¡è°ƒç”¨.</p><h4 id="ä¸‹èŠ‚é¢„å‘Š-Reactä¸­çš„äº‹ä»¶æœºåˆ¶"><a href="#ä¸‹èŠ‚é¢„å‘Š-Reactä¸­çš„äº‹ä»¶æœºåˆ¶" class="headerlink" title="ä¸‹èŠ‚é¢„å‘Š: Reactä¸­çš„äº‹ä»¶æœºåˆ¶."></a>ä¸‹èŠ‚é¢„å‘Š: Reactä¸­çš„äº‹ä»¶æœºåˆ¶.</h4>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;transaction&lt;/code&gt; &lt;code&gt;batch operation&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;äº‹åŠ¡-Transaction-çš„åŸç†&quot;&gt;&lt;a href=&quot;#äº‹åŠ¡-Transaction-çš„åŸç†&quot; class=&quot;headerlink&quot; title=&quot;äº‹åŠ¡(Transaction)çš„åŸç†&quot;&gt;&lt;/a&gt;äº‹åŠ¡(Transaction)çš„åŸç†&lt;/h3&gt;&lt;p&gt;åœ¨å‰é¢æœ‰å‡ èŠ‚ä¸­åå¤æåˆ°äº†Reactçš„äº‹åŠ¡æœºåˆ¶(Transaction), ä»Šå¤©å°±å‡†å¤‡æ¥è®²ä¸€è®²è¿™ä¸ªäº‹åŠ¡æœºåˆ¶åˆ°åº•æ˜¯æ€ä¹ˆä¸ªä¸€å›äº‹.&lt;br&gt;ç”¨ä¸€å¥ç®€å•ä¸€ç‚¹çš„è¯æ¥å½¢å®¹è¿™ä¸ªä¸œè¥¿å°±æ˜¯: åœ¨è°ƒç”¨æŸä¸€ä¸ªå…·ä½“çš„æ–¹æ³•ä¹‹å‰ä¸ä¹‹å, å…ˆè°ƒç”¨ä¸€ç³»åˆ—çš„å¤„ç†å‡½æ•°, ç±»ä¼¼äº&lt;code&gt;npm install&lt;/code&gt;å¯¹åº”çš„&lt;code&gt;npm preinstall&lt;/code&gt;å’Œ&lt;code&gt;npm postinstall&lt;/code&gt;, åˆ†åˆ«æ‰§è¡Œäº&lt;code&gt;npm install&lt;/code&gt;è¿™ä¸ªè„šæœ¬çš„å¼€å§‹ä¹‹å‰ä¸å®Œæˆä¹‹å.&lt;/p&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ—-Â§2.2-ä»è™šæ‹ŸDOMåˆ°çœŸå®DOM</title>
    <link href="https://jeremywu.info/2018/08/04/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A72.2-%E4%BB%8E%E8%99%9A%E6%8B%9FDOM%E5%88%B0%E7%9C%9F%E5%AE%9EDOM/"/>
    <id>https://jeremywu.info/2018/08/04/Reactæºç é˜…è¯»ç³»åˆ—-Â§2.2-ä»è™šæ‹ŸDOMåˆ°çœŸå®DOM/</id>
    <published>2018-08-04T15:20:00.000Z</published>
    <updated>2018-08-04T15:58:26.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>è™šæ‹ŸDOM</code> <code>çœŸå®DOM</code></p><h3 id="ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹"><a href="#ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹" class="headerlink" title="ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹"></a>ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹</h3><p>å½“ç»è¿‡æŒ‚è½½/æ›´æ–°, Reactè‡ªå·±ç®¡ç†çš„é‚£ä»½DOMèŠ‚ç‚¹éƒ½ä¼šè¢«æ›´æ–°, æ— è®ºæ˜¯ä»æ— åˆ°æœ‰äº¦æˆ–æ˜¯ä»æ—§åˆ°æ–°, éƒ½éœ€è¦ç»å†çš„ä»è™šæ‹Ÿçš„DOMé“¾æ¥åˆ°çœŸå®çš„DOMå½“ä¸­ç„¶åæ‰èƒ½è¢«æµè§ˆå™¨è¡¨ç°åœ¨é¡µé¢ä¸Š.<br>é‚£ä¹ˆè¿™ä¸€éƒ¨åˆ†åŠŸèƒ½åˆ°åº•æ˜¯æ€ä¹ˆå®Œæˆçš„å‘¢? ä»<a href="/2018/07/26/Reactæºç é˜…è¯»ç³»åˆ—-Â§2.1-ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯¦è§£/">ä¸Šä¸€èŠ‚</a>ä¸­äº†è§£åˆ°äº†Reactè™šæ‹ŸDOMæ¸²æŸ“å‡ºæ¥çš„DOMç‰‡æ®µåˆ°åº•é•¿ä»€ä¹ˆæ ·, æ¥ä¸‹æ¥å°±è¦çŸ¥é“çš„æ˜¯è¿™ä¸ªä¸œè¥¿åˆ°åº•æ˜¯æ€ä¹ˆè¢«æ¸²æŸ“è¿›å…¥æµè§ˆå™¨çš„DOMå¯¹è±¡å½“ä¸­çš„.</p><a id="more"></a><h4 id="ReactMount-mountImageIntoNode"><a href="#ReactMount-mountImageIntoNode" class="headerlink" title="ReactMount._mountImageIntoNode"></a>ReactMount._mountImageIntoNode</h4><p>æ­¤å¤„ç”¨æŒ‚è½½æ—¶çš„å‡½æ•°æ–¹æ³•æ¥ä¸¾ä¾‹, æ›´æ–°çš„æŒ‚è½½æ“ä½œç±»ä¼¼, ä½†æˆ‘ä»¬åªå…³æ³¨æ›´æ–°æ“ä½œçš„æ›´æ–°ç­–ç•¥.</p><p><code>ReactMount.mountComponentIntoNode</code>æ–¹æ³•çš„æœ€åé€šè¿‡è°ƒç”¨<code>ReactMount._mountImageIntoNode</code>æ¥æŠŠæ¸²æŸ“å¥½çš„DOMç‰‡æ®µé“¾æ¥åˆ°DOMå½“ä¸­å»<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ReactMount._mountImageIntoNode = <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    markup,</span></span></span><br><span class="line"><span class="function"><span class="params">    container,</span></span></span><br><span class="line"><span class="function"><span class="params">    instance,</span></span></span><br><span class="line"><span class="function"><span class="params">    shouldReuseMarkup,</span></span></span><br><span class="line"><span class="function"><span class="params">    transaction,</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ... çœç•¥æ‰ä¸€äº›ServerRenderingçš„å¤„ç†ä»£ç ä»¥åŠå¼€å‘é˜¶æ®µæŠ¥é”™çš„ä»£ç </span></span><br><span class="line">    <span class="keyword">if</span> (transaction.useCreateElement) &#123;</span><br><span class="line">      <span class="keyword">while</span> (container.lastChild) &#123;</span><br><span class="line">        container.removeChild(container.lastChild);</span><br><span class="line">      &#125;</span><br><span class="line">      DOMLazyTree.insertTreeBefore(container, markup, <span class="literal">null</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      setInnerHTML(container, markup);</span><br><span class="line">      ReactDOMComponentTree.precacheNode(instance, container.firstChild);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé€šè¿‡<code>DOMLazyTree.insertTreeBefore</code>æ–¹æ³•, æŠŠæ¸²æŸ“å¥½çš„DOMç‰‡æ®µå¡åˆ°äº†çœŸå®çš„DOMé‡Œ<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­¤å¤„æ–¹æ³•ç»è¿‡ä¸€äº›ç‰¹æ®Šå¤„ç†... æ¥å¤„ç†M$çš„å…¼å®¹æ€§</span></span><br><span class="line"><span class="keyword">var</span> insertTreeBefore = <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  parentNode,</span></span></span><br><span class="line"><span class="function"><span class="params">  tree,</span></span></span><br><span class="line"><span class="function"><span class="params">  referenceNode,</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    tree.node.nodeType === DOCUMENT_FRAGMENT_NODE_TYPE ||</span><br><span class="line">    (tree.node.nodeType === ELEMENT_NODE_TYPE &amp;&amp;</span><br><span class="line">      tree.node.nodeName.toLowerCase() === <span class="string">'object'</span> &amp;&amp;</span><br><span class="line">      (tree.node.namespaceURI == <span class="literal">null</span> ||</span><br><span class="line">        tree.node.namespaceURI === DOMNamespaces.html))</span><br><span class="line">  ) &#123;</span><br><span class="line">    insertTreeChildren(tree);</span><br><span class="line">    parentNode.insertBefore(tree.node, referenceNode);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    parentNode.insertBefore(tree.node, referenceNode);</span><br><span class="line">    insertTreeChildren(tree);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p><code>parentNode.insertBefore</code>æ–¹æ³•å°±æ˜¯DOMæ–¹æ³•<a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore" target="_blank" rel="noopener">Node.insertBefre</a>æ–¹æ³•. åˆ°è¿™è¾¹ç»“æŸä¹‹åæ¸²æŸ“å¥½çš„DOMç‰‡æ®µå°±è¢«æ­£å¼æŒ‚è½½è¿›å…¥äº†DOMå½“ä¸­.</p><h4 id="ä¸‹èŠ‚é¢„å‘Š-Reactä¸­çš„äº‹åŠ¡å¤„ç†"><a href="#ä¸‹èŠ‚é¢„å‘Š-Reactä¸­çš„äº‹åŠ¡å¤„ç†" class="headerlink" title="ä¸‹èŠ‚é¢„å‘Š:  Reactä¸­çš„äº‹åŠ¡å¤„ç†."></a>ä¸‹èŠ‚é¢„å‘Š:  Reactä¸­çš„äº‹åŠ¡å¤„ç†.</h4>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;è™šæ‹ŸDOM&lt;/code&gt; &lt;code&gt;çœŸå®DOM&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹&quot;&gt;&lt;a href=&quot;#ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹&quot;&gt;&lt;/a&gt;ä»è™šæ‹ŸDOMèŠ‚ç‚¹é“¾æ¥åˆ°çœŸå®çš„DOMèŠ‚ç‚¹&lt;/h3&gt;&lt;p&gt;å½“ç»è¿‡æŒ‚è½½/æ›´æ–°, Reactè‡ªå·±ç®¡ç†çš„é‚£ä»½DOMèŠ‚ç‚¹éƒ½ä¼šè¢«æ›´æ–°, æ— è®ºæ˜¯ä»æ— åˆ°æœ‰äº¦æˆ–æ˜¯ä»æ—§åˆ°æ–°, éƒ½éœ€è¦ç»å†çš„ä»è™šæ‹Ÿçš„DOMé“¾æ¥åˆ°çœŸå®çš„DOMå½“ä¸­ç„¶åæ‰èƒ½è¢«æµè§ˆå™¨è¡¨ç°åœ¨é¡µé¢ä¸Š.&lt;br&gt;é‚£ä¹ˆè¿™ä¸€éƒ¨åˆ†åŠŸèƒ½åˆ°åº•æ˜¯æ€ä¹ˆå®Œæˆçš„å‘¢? ä»&lt;a href=&quot;/2018/07/26/Reactæºç é˜…è¯»ç³»åˆ—-Â§2.1-ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯¦è§£/&quot;&gt;ä¸Šä¸€èŠ‚&lt;/a&gt;ä¸­äº†è§£åˆ°äº†Reactè™šæ‹ŸDOMæ¸²æŸ“å‡ºæ¥çš„DOMç‰‡æ®µåˆ°åº•é•¿ä»€ä¹ˆæ ·, æ¥ä¸‹æ¥å°±è¦çŸ¥é“çš„æ˜¯è¿™ä¸ªä¸œè¥¿åˆ°åº•æ˜¯æ€ä¹ˆè¢«æ¸²æŸ“è¿›å…¥æµè§ˆå™¨çš„DOMå¯¹è±¡å½“ä¸­çš„.&lt;/p&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ—-Â§2.1-ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯¦è§£</title>
    <link href="https://jeremywu.info/2018/07/26/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A72.1-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3/"/>
    <id>https://jeremywu.info/2018/07/26/Reactæºç é˜…è¯»ç³»åˆ—-Â§2.1-ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯¦è§£/</id>
    <published>2018-07-26T13:18:31.000Z</published>
    <updated>2018-08-02T14:51:52.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>ç”Ÿå‘½å‘¨æœŸ</code> <code>é’©å­å‡½æ•°</code></p><p>åœ¨<a href="/2018/07/17/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.1-ç”Ÿå‘½å‘¨æœŸ-Lifecycle">Â§1.1èŠ‚</a>å¤§æ¦‚çš„äº†è§£äº†Reactçš„ç”Ÿå‘½å‘¨æœŸä»¥åŠåœ¨å„ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°çš„è°ƒç”¨.</p><p>åœ¨æœ¬èŠ‚ä¸»è¦è¯¦ç»†è®²è§£å„ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°, ä»¥åŠä¸€äº›å¯¹æ€§èƒ½ä¸Šèƒ½å¤Ÿäº§ç”Ÿä¼˜åŒ–çš„ç»†èŠ‚.</p><a id="more"></a><div class="tip"><br>ä»¥ä¸‹é¢å†…å®¹ä»…é€‚ç”¨äºç”¨æˆ·è‡ªå®šä¹‰ç»„ä»¶, æ— çŠ¶æ€ç»„ä»¶ä¸ç»å†å¤§éƒ¨åˆ†é’©å­å‡½æ•°çš„è°ƒç”¨.<br></div><hr><h3 id="ç”Ÿå‘½å‘¨æœŸçš„é˜¶æ®µ"><a href="#ç”Ÿå‘½å‘¨æœŸçš„é˜¶æ®µ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸçš„é˜¶æ®µ"></a>ç”Ÿå‘½å‘¨æœŸçš„é˜¶æ®µ</h3><p><strong>æ¯ä¸€ä¸ª</strong>Reactçš„ç»„ä»¶éƒ½ä¼šç»å†å®ƒçš„ç”Ÿå‘½å‘¨æœŸ.</p><h4 id="1-æŒ‚è½½é˜¶æ®µ-Mounting-Period"><a href="#1-æŒ‚è½½é˜¶æ®µ-Mounting-Period" class="headerlink" title="1. æŒ‚è½½é˜¶æ®µ (Mounting Period)"></a>1. æŒ‚è½½é˜¶æ®µ (Mounting Period)</h4><ul><li><p>1) ç»„ä»¶è¢«å®ä¾‹åŒ–</p><p>åœ¨ä¹‹å‰çš„<a href="/2018/07/21/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.4-æ¥äºº-ç»™æˆ‘newä¸€ä¸‹">Â§1.3èŠ‚</a>è®²åˆ°æ¯ä¸€ä¸ª<code>CustomComponent</code>éƒ½æ˜¯è¢«<code>CompositeComponentWrapper</code>ç»™åŒ…è£¹äº†èµ·æ¥, å®é™…è¢«å®ä¾‹åŒ–çš„åœ°æ–¹æ˜¯åœ¨<code>ReactCompositeComponent._constructComponentWithoutOwner</code>æ–¹æ³•ä¸­.</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> CustomComponent(publicProps, publicContext, updateQueue);</span><br></pre></td></tr></table></figure><p>æ­¤å¤„å°±æ˜¯æ‰€æœ‰çš„ç»„ä»¶çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨çš„åœ°æ–¹. ä¸ºçš„æ˜¯æŠŠå®ä¾‹å­˜åœ¨<code>ReactInstanceMap</code>ä¸­, æ–¹ä¾¿ä½¿ç”¨, ä¾‹å¦‚<code>React.findDOMNode()</code>æ–¹æ³•å°±é€šè¿‡è¿™ä¸ª<code>ReactInstanceMap</code>æ‹¿åˆ°äº†å®ä¾‹é€šè¿‡å®ä¾‹åœ¨å¯¹åº”çš„<code>ReactDOMTree</code>ä¸­æ‰¾åˆ°äº†å¯¹åº”çš„DOMèŠ‚ç‚¹.</p></li><li><p>2) componentWillMountçš„è°ƒç”¨</p><p>æ— çŠ¶æ€ç»„ä»¶æ˜¯ä¸ç»å†è¿™ä¸€æ­¥çš„, å¦‚æœç”¨æˆ·æœ‰æ·»åŠ <code>componentWillMount</code>è¿™ä¸ªæ–¹æ³•, é‚£ä¹ˆè¯¥æ–¹æ³•å°†ä¼šåœ¨<code>performInitialMount</code>æ–¹æ³•å†…è¢«è°ƒç”¨.</p></li><li><p>3) renderçš„è°ƒç”¨æ—¶æœº</p><p>renderè¢«è°ƒç”¨æœ‰ä¸¤ç§æƒ…å†µ. </p><ol><li><p>ç¬¬ä¸€ç§æƒ…å†µæ˜¯å¦‚æœç»„ä»¶æœ¬èº«æ˜¯æ— çŠ¶æ€ç»„ä»¶é‚£ä¹ˆåœ¨</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> renderedElement;</span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯æ— çŠ¶æ€çš„ç»„ä»¶è¿”å›false, å¦åˆ™è¿”å›true.</span></span><br><span class="line"><span class="keyword">var</span> doConstruct = shouldConstruct(Component);</span><br><span class="line"><span class="keyword">var</span> inst = <span class="keyword">this</span>._constructComponent(</span><br><span class="line">    doConstruct, <span class="comment">// false</span></span><br><span class="line">    publicProps,</span><br><span class="line">    publicContext,</span><br><span class="line">    updateQueue,</span><br><span class="line">  );</span><br><span class="line"><span class="keyword">if</span> (!doConstruct &amp;&amp; (inst == <span class="literal">null</span> || inst.render == <span class="literal">null</span>)) &#123;</span><br><span class="line">  renderedElement = inst; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•å†…éƒ¨è¿™ä¸ªç»„ä»¶çš„<code>render</code>æ–¹æ³•å°±å¯ä»¥çœ‹åšå·²ç»è¢«è°ƒç”¨è¿‡äº†, å› ä¸ºæœ¬èº«å°±åªæ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹çš„ç»„ä»¶.</p></li><li>ç¬¬äºŒç§æ˜¯å¦‚æœå¹¶éæ— çŠ¶æ€ç»„ä»¶, é‚£ä¹ˆ<code>render</code>çš„è°ƒç”¨å‘ç”Ÿåœ¨<code>performInitialMount</code>æ–¹æ³•ä¸­<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ä¸æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶æ—¶, renderedElementè‡ªç„¶ä¸ºundefined.</span></span><br><span class="line"><span class="keyword">if</span> (renderedElement === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    renderedElement = <span class="keyword">this</span>._renderValidatedComponent(); <span class="comment">// æ­¤å¤„è°ƒç”¨inst.render()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>è¿™é‡Œçš„<code>renderedElement</code>å°±æ˜¯åœ¨ç¬¬<a href="/2018/07/18/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.2å…ˆæœ‰èŠ‚ç‚¹åæœ‰å¤©%20ReactCreateElement">Â§1.2èŠ‚</a>é€šè¿‡<code>render()</code>æ–¹æ³•è¿”å›å‡ºæ¥çš„<code>React.createElement()</code>çš„ç»“æ„. æ˜¯ä¸€ä¸ª<code>ReactElement</code>çš„ç±»å®ä¾‹. ç„¶åä¼šè¢«ç”¨æ¥é€šè¿‡è¿›è¡Œä¸€ä¸ªé€’å½’è°ƒç”¨, æ‰€æœ‰çš„è‡ªå®šä¹‰ç»„ä»¶éƒ½ä¼šè¢«è½¬æ¢åˆ°<code>ReactDOMComponent</code>, ç„¶åé€šè¿‡<code>ReactDOMComponent.mountComponent</code>æ–¹æ³•è¿”å›ä¸€æ®µ<code>ReactNode</code>çš„å¯¹è±¡å®ä¾‹</p><p>æœ€åè°ƒç”¨<code>render</code>æ–¹æ³•ä¹‹åå¾—åˆ°çš„markupç±»ä¼¼äº:</p><img src="/2018/07/26/Reactæºç é˜…è¯»ç³»åˆ—-Â§2.1-ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹è¯¦è§£/markup.png" title="markup"><p>ä»<code>ReactCompositeComponent</code>åˆ°<code>ReactDOMComponent</code>, ç„¶åå†è¢«è½¬æ¢æˆä¸ºçœŸå®çš„<code>DOM</code>èŠ‚ç‚¹<strong>(åˆ’é‡ç‚¹: DOMèŠ‚ç‚¹å†…åªæœ‰å­—ç¬¦ä¸²)</strong>. åœ¨<code>ReactDOMComponent</code>å½“ä¸­æœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ–¹æ³•: </p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>._createInitialChildren = <span class="function"><span class="keyword">function</span>(<span class="params">transaction, props, context, lazyTree</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> innerHTML = props.dangerouslySetInnerHTML;</span><br><span class="line">  <span class="keyword">if</span> (innerHTML != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (innerHTML.__html != <span class="literal">null</span>) &#123;</span><br><span class="line">      DOMLazyTree.queueHTML(lazyTree, innerHTML.__html);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> contentToUse = CONTENT_TYPES[<span class="keyword">typeof</span> props.children]</span><br><span class="line">      ? props.children</span><br><span class="line">      : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">var</span> childrenToUse = contentToUse != <span class="literal">null</span> ? <span class="literal">null</span> : props.children;</span><br><span class="line">    <span class="keyword">if</span> (contentToUse != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (contentToUse !== <span class="string">''</span>) &#123;</span><br><span class="line">        DOMLazyTree.queueText(lazyTree, contentToUse);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenToUse != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> mountImages = <span class="keyword">this</span>.mountChildren(</span><br><span class="line">        childrenToUse,</span><br><span class="line">        transaction,</span><br><span class="line">        context,</span><br><span class="line">      );</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; mountImages.length; i++) &#123;</span><br><span class="line">        DOMLazyTree.queueChild(lazyTree, mountImages[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•çš„è§£é‡Šä¸€ä¸‹è¿™æ®µæ–¹æ³•:</p><ol><li>é¦–å…ˆå…ˆå»åˆ¤æ–­äº†æ˜¯å¦æœ‰å¼ºè¡Œå¡å…¥<code>innerHTML</code>çš„è¿™ç§åšæ³•, å¾ˆæ˜¾ç„¶å®˜æ–¹æœ¬èº«æ˜¯ä¸æ¨èç”¨æˆ·è¿™æ ·å»ä½¿ç”¨, ä½†æ˜¯åœ¨æŸä¸€äº›çš„ç‰¹å®šåœºæ™¯ä¸‹, å¿…é¡»è¦ç”¨åˆ°è¿™ç§æ–¹æ³•.<ul><li><code>true</code>, å°±æŠŠ<code>__html</code>ä½œä¸ºå½“å‰èŠ‚ç‚¹çš„<code>innerHTML</code>.</li><li><code>false</code>, ç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥.</li></ul></li><li>æ¥ç€å»åˆ¤æ–­å½“å‰çš„<code>children</code>æ˜¯å¦æ˜¯<code>CONTENT_TYPES</code>è¿™ä¸ªæšä¸¾ç±»çš„æˆå‘˜.<ul><li><code>true</code>, é‚£å°±æŠŠ<code>children</code>å¡ç»™å½“å‰çš„èŠ‚ç‚¹ä½œä¸º<code>innerHTML</code>.</li><li><code>false</code>, é‚£ä¹ˆå°±è¯æ˜ç°åœ¨çš„è¿™ä¸ª<code>children</code>å¹¶éæ˜¯ä¸€ä¸ª<code>DOM</code>èŠ‚ç‚¹è€Œæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç»„ä»¶. é‚£å°±ç»§ç»­è°ƒç”¨<code>instantiateReactComponent</code>æ–¹æ³•æ¥å®ä¾‹åŒ–<code>children</code>ç›´åˆ°æ‰€æœ‰çš„å­èŠ‚ç‚¹è¢«åˆ›å»ºå®Œæˆ.<div class="tip">æ³¨æ„: æ­¤å¤„æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨çš„è¿‡ç¨‹</div></li></ul></li></ol><p>åˆ°è¿™ä¸ªåœ°æ–¹, åŸºæœ¬<code>render</code>æ–¹æ³•çš„è°ƒç”¨å°±ç»“æŸäº†, è°ƒç”¨å®Œæˆçš„ç»“æœå°±æ˜¯ä¸Šé¢å›¾ä¾‹çš„<code>markup</code>å¯¹è±¡.</p></li></ul><ul><li><p>4) componentDidMountçš„è°ƒç”¨: </p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (inst.componentDidMount) &#123;</span><br><span class="line">  transaction.getReactMountReady().enqueue(inst.componentDidMount, inst);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡ŒReactçš„å¼€å‘è€…ä»¬å¾ˆèªæ˜çš„é‡‡ç”¨äº†ä¸€ä¸ªé˜Ÿåˆ—çš„å½¢å¼, é‡‡ç”¨æ‰¹å¤„ç†çš„æ–¹å¼æ¥è°ƒç”¨<code>componentDidMount</code>çš„æ–¹æ³•.<br>åˆ°è¿™ä¸ªåœ°æ–¹, Reactçš„æŒ‚è½½é˜¶æ®µåŸºæœ¬å°±å·²ç»ç»“æŸäº†. å¯¹äº<code>äº‹åŠ¡å¤„ç†</code>ä»¥åŠ<code>äº‹ä»¶æœºåˆ¶</code>è¿˜æœ‰<code>å¯¹è±¡æ± </code>çš„æ¦‚å¿µ, åˆ°åé¢ä¼šå†è¯´åˆ°.</p></li></ul><h4 id="2-å­˜åœ¨é˜¶æ®µ"><a href="#2-å­˜åœ¨é˜¶æ®µ" class="headerlink" title="2. å­˜åœ¨é˜¶æ®µ"></a>2. å­˜åœ¨é˜¶æ®µ</h4><p>  å­˜åœ¨é˜¶æ®µä¸»è¦å¯¹åº”çš„ä¸»è¦æ˜¯å¯¹æµè§ˆå™¨äº‹ä»¶çš„ä¸€ä¸ªå“åº”, å› ä¸ºç”¨æˆ·æ“ä½œè€Œè§¦å‘çš„ä¸€ç³»åˆ—æµè§ˆå™¨äº‹ä»¶.<br>  æ¥ä¸‹æ¥çš„æ›´æ–°éƒ½æ˜¯äº¤äº’åäº§ç”Ÿçš„æ›´æ–°æ“ä½œ, æµè§ˆå™¨å“åº”ç›¸åº”çš„äº‹ä»¶æœ€åè¢«setStateæˆ–æ”¹å˜propsè§¦å‘æ›´æ–°. (setStateä¼šåœ¨åé¢ç« èŠ‚è¿›è¡Œè¯¦ç»†çš„ä»‹ç»).</p><ol><li><p>ä¸»æ’­å†ä¸æ›´æ–°æˆ‘å°±é€€è®¢! updateComponent (è¿™é‡Œä»¥ReactCompositeComponent <strong>[è‡ªå®šä¹‰ç»„ä»¶]</strong>ä¸ºä¾‹)</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> updateComponent = <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    transaction,</span></span></span><br><span class="line"><span class="function"><span class="params">    prevParentElement,</span></span></span><br><span class="line"><span class="function"><span class="params">    nextParentElement,</span></span></span><br><span class="line"><span class="function"><span class="params">    prevUnmaskedContext,</span></span></span><br><span class="line"><span class="function"><span class="params">    nextUnmaskedContext,</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> inst = <span class="keyword">this</span>._instance;</span><br><span class="line">    invariant( <span class="comment">// å¦‚æœå¯¹å·²ç»è¢«å¸è½½æ‰çš„èŠ‚ç‚¹è°ƒç”¨è¿™ä¸ªæ–¹æ³•åˆ™æŠ›å¼‚å¸¸</span></span><br><span class="line">      inst != <span class="literal">null</span>,</span><br><span class="line">      <span class="string">'Attempted to update component `%s` that has already been unmounted '</span> +</span><br><span class="line">        <span class="string">'(or failed to mount).'</span>,</span><br><span class="line">      <span class="keyword">this</span>.getName() || <span class="string">'ReactCompositeComponent'</span>,</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">var</span> willReceive = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">var</span> nextContext;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥contextä¸Šçš„å€¼æ˜¯å¦ä¸€è‡´</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._context === nextUnmaskedContext) &#123;</span><br><span class="line">      nextContext = inst.context;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      nextContext = <span class="keyword">this</span>._processContext(nextUnmaskedContext);</span><br><span class="line">      willReceive = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> prevProps = prevParentElement.props;</span><br><span class="line">    <span class="keyword">var</span> nextProps = nextParentElement.props;</span><br><span class="line">    <span class="comment">// å¯¹æ¯”å‰åçš„Elementæ˜¯å¦ç›¸åŒ</span></span><br><span class="line">    <span class="keyword">if</span> (prevParentElement !== nextParentElement) &#123;</span><br><span class="line">      <span class="comment">// æ›´æ–°æ ‡è¯†ç¬¦è®¾ç½®ä¸ºtrue</span></span><br><span class="line">      willReceive = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (willReceive &amp;&amp; inst.componentWillReceiveProps) &#123;</span><br><span class="line">      inst.componentWillReceiveProps(nextProps, nextContext);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> nextState = <span class="keyword">this</span>._processPendingState(nextProps, nextContext); <span class="comment">// æ‹¿åˆ°ä¸‹ä¸€ä¸ªæ—¶é—´çš„state</span></span><br><span class="line">    <span class="keyword">var</span> shouldUpdate = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>._pendingForceUpdate) &#123;</span><br><span class="line">      <span class="keyword">if</span> (inst.shouldComponentUpdate) &#123;</span><br><span class="line">          shouldUpdate = inst.shouldComponentUpdate(<span class="comment">// &lt;- å®ä¾‹shouldComponentUpdateé’©å­è°ƒç”¨</span></span><br><span class="line">            nextProps,</span><br><span class="line">            nextState,</span><br><span class="line">            nextContext,</span><br><span class="line">          );</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†ä¸€ä¸ªPureComponentçš„æ¡ä»¶, å…³äºPureComponentä¸Componentçš„å¯¹æ¯”</span></span><br><span class="line">        <span class="comment">// å¯ä»¥åœ¨ç»™åˆ°çš„å‡ ä¸ªé“¾æ¥é‡Œå¤šçœ‹çœ‹è¿™é‡Œå°±ä¸å¤šåšè§£é‡Š</span></span><br><span class="line">        <span class="comment">// https://60devs.com/pure-component-in-react.html</span></span><br><span class="line">        <span class="comment">// https://stackoverflow.com/questions/41340697/react-component-vs-react-purecomponent</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>._compositeType === CompositeTypes.PureClass) &#123;</span><br><span class="line">          shouldUpdate =</span><br><span class="line">            !shallowEqual(prevProps, nextProps) ||</span><br><span class="line">            !shallowEqual(inst.state, nextState);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>._updateBatchNumber = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°shouldUpdateè¿™ä¸ªå€¼é»˜è®¤éƒ½æ˜¯è¢«è®¾ç½®ä¸ºtrueçš„, æ‰€ä»¥åœ¨æ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™, å¯ä»¥è€ƒè™‘ä½¿ç”¨</span></span><br><span class="line">    <span class="comment">// shouldComponentUpdateè¿™ä¸ªé’©å­å‡½æ•°æ¥æ§åˆ¶ä¸€ä¸‹é‡ç»˜çš„ç»„ä»¶çš„æ•°é‡æ¥è¾¾åˆ°å‡å°‘é‡ç»˜è°ƒç”¨ä¼˜åŒ–æ€§èƒ½çš„ç›®çš„</span></span><br><span class="line">    <span class="keyword">if</span> (shouldUpdate) &#123;</span><br><span class="line">      <span class="keyword">this</span>._pendingForceUpdate = <span class="literal">false</span>;</span><br><span class="line">      <span class="comment">// ä¼ é€’æ–°çš„å±æ€§, çŠ¶æ€, ä¸Šä¸‹æ–‡è¿›è¡Œæ›´æ–°</span></span><br><span class="line">      <span class="keyword">this</span>._performComponentUpdate(</span><br><span class="line">        nextParentElement,</span><br><span class="line">        nextProps,</span><br><span class="line">        nextState,</span><br><span class="line">        nextContext,</span><br><span class="line">        transaction,</span><br><span class="line">        nextUnmaskedContext,</span><br><span class="line">      );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>._currentElement = nextParentElement;</span><br><span class="line">      <span class="keyword">this</span>._context = nextUnmaskedContext;</span><br><span class="line">      inst.props = nextProps;</span><br><span class="line">      inst.state = nextState;</span><br><span class="line">      inst.context = nextContext;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>åœ¨åˆ¤æ–­å®Œéœ€è¦æ›´æ–°è¿™ä¸ªç»“æœä¹‹å, å°±è¦è¿›è¡Œæ¥ä¸‹æ¥çš„<code>performUpdate</code>æ“ä½œ.</p></li><li><p>å¼€å§‹ä½ çš„è¡¨æ¼” performUpdate</p><p>performUpdateé¡¾åæ€ä¹‰å°±æ˜¯è¦è¿›è¡Œå®é™…çš„æ›´æ–°æ“ä½œäº†, æ›´æ–°æ“ä½œå®é™…ä¸Šå¤§è‡´ä¸åˆå§‹çš„æŒ‚è½½æ“ä½œä¸€è‡´. ä»£ç èµ°ä½ !</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">_performComponentUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  nextElement,</span></span></span><br><span class="line"><span class="function"><span class="params">  nextProps,</span></span></span><br><span class="line"><span class="function"><span class="params">  nextState,</span></span></span><br><span class="line"><span class="function"><span class="params">  nextContext,</span></span></span><br><span class="line"><span class="function"><span class="params">  transaction,</span></span></span><br><span class="line"><span class="function"><span class="params">  unmaskedContext,</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> inst = <span class="keyword">this</span>._instance;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hasComponentDidUpdate = <span class="built_in">Boolean</span>(inst.componentDidUpdate);</span><br><span class="line">  <span class="keyword">var</span> prevProps;</span><br><span class="line">  <span class="keyword">var</span> prevState;</span><br><span class="line">  <span class="keyword">var</span> prevContext;</span><br><span class="line">  <span class="keyword">if</span> (hasComponentDidUpdate) &#123;</span><br><span class="line">    prevProps = inst.props;</span><br><span class="line">    prevState = inst.state;</span><br><span class="line">    prevContext = inst.context;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (inst.componentWillUpdate) &#123;</span><br><span class="line">    <span class="comment">// ğŸ‘‡ willUpdate é’©å­å‡½æ•°è°ƒç”¨</span></span><br><span class="line">    inst.componentWillUpdate(nextProps, nextState, nextContext);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>._currentElement = nextElement;</span><br><span class="line">  <span class="keyword">this</span>._context = unmaskedContext;</span><br><span class="line">  inst.props = nextProps;</span><br><span class="line">  inst.state = nextState;</span><br><span class="line">  inst.context = nextContext;</span><br><span class="line">  <span class="comment">// æŠŠæ›´æ–°ä¼ é€’åˆ°DOMä¸Šå» è¿™è¾¹çš„æ›´æ–°è·ŸæŒ‚è½½æ—¶çš„æ“ä½œå¾ˆç›¸ä¼¼ æ‰€ä»¥å°±ä¸åšå±•å¼€äº†.</span></span><br><span class="line">  <span class="keyword">this</span>._updateRenderedComponent(transaction, unmaskedContext);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (hasComponentDidUpdate) &#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®å¥½æœ€åä¸€ä¸ªæ›´æ–°çš„é’©å­å‡½æ•°, åœ¨äº‹åŠ¡æ“ä½œç»“æŸä¹‹åè°ƒç”¨</span></span><br><span class="line">    transaction</span><br><span class="line">      .getReactMountReady()</span><br><span class="line">      .enqueue(</span><br><span class="line">        inst.componentDidUpdate.bind(</span><br><span class="line">          inst,</span><br><span class="line">          prevProps,</span><br><span class="line">          prevState,</span><br><span class="line">          prevContext,</span><br><span class="line">        ),</span><br><span class="line">        inst,</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³äºåœ¨æœ€å, æ€ä¹ˆæŠŠè¿™äº›èŠ‚ç‚¹ç»™åæ˜ åˆ°åˆ°DOMä¸Šå»çš„å‘¢? è¯·çœ‹ä¸‹å›åˆ†è§£.</p></li></ol><h3 id="ä¸‹èŠ‚é¢„å‘Š-ä»è™šæ‹ŸDOMåˆ°çœŸå®çš„DOM"><a href="#ä¸‹èŠ‚é¢„å‘Š-ä»è™šæ‹ŸDOMåˆ°çœŸå®çš„DOM" class="headerlink" title="ä¸‹èŠ‚é¢„å‘Š: ä»è™šæ‹ŸDOMåˆ°çœŸå®çš„DOM."></a>ä¸‹èŠ‚é¢„å‘Š: ä»è™šæ‹ŸDOMåˆ°çœŸå®çš„DOM.</h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/code&gt; &lt;code&gt;é’©å­å‡½æ•°&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åœ¨&lt;a href=&quot;/2018/07/17/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.1-ç”Ÿå‘½å‘¨æœŸ-Lifecycle&quot;&gt;Â§1.1èŠ‚&lt;/a&gt;å¤§æ¦‚çš„äº†è§£äº†Reactçš„ç”Ÿå‘½å‘¨æœŸä»¥åŠåœ¨å„ä¸ªé˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°çš„è°ƒç”¨.&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬èŠ‚ä¸»è¦è¯¦ç»†è®²è§£å„ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°, ä»¥åŠä¸€äº›å¯¹æ€§èƒ½ä¸Šèƒ½å¤Ÿäº§ç”Ÿä¼˜åŒ–çš„ç»†èŠ‚.&lt;/p&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ—-Â§1.5-ReactDOM.renderå¹²äº†å•¥</title>
    <link href="https://jeremywu.info/2018/07/22/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A71.5-ReactDOM-render%E5%B9%B2%E4%BA%86%E5%95%A5/"/>
    <id>https://jeremywu.info/2018/07/22/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.5-ReactDOM-renderå¹²äº†å•¥/</id>
    <published>2018-07-22T14:01:06.000Z</published>
    <updated>2018-07-26T13:13:46.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>ReactDOM.render</code> <code>è°ƒç”¨æ ˆ</code></p><p>Reactåº”ç”¨çš„å¯åŠ¨å¯è°“æ˜¯ç›¸å½“ç®€å•äº†, æ— éœ€è¿‡å¤šçš„é…ç½®, åªéœ€è¦ä¸‰è¡Œä»£ç ä¾¿å¯ä»¥å¯åŠ¨</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;render&#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line">render((<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>å¯åŠ¨!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>), <span class="built_in">document</span>.querySelector(<span class="string">'#root'</span>));</span><br></pre></td></tr></table></figure><a id="more"></a><p><code>ReactDOM.render</code>æ–¹æ³•ä¸€å…±æ¥å—ä¸‰ä¸ªå‚æ•°:<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render = <span class="function"><span class="keyword">function</span>(<span class="params">nextElement, container, callback</span>) </span>&#123;...&#125;;</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦æ¸²æŸ“çš„<code>ReactElement</code>;<br>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‚è½½æ¸²æŸ“å¥½çš„DOMèŠ‚ç‚¹çš„<code>Container</code>;<br>ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¯é€‰å‚æ•°,ç”¨æ¥æ¥å—ä¸€ä¸ªåœ¨è¯¥æ–¹æ³•ç»“æŸä¹‹åè¢«è°ƒç”¨çš„ä¸€ä¸ª<code>Function</code>;</p><p>ç»“åˆä¸Šä¸€äº›ä»£ç æ¥äº†è§£ä¸€ä¸‹, è¯¥æ–¹æ³•è¢«è°ƒç”¨æ—¶åˆ°åº•ç»è¿‡äº†å“ªä¸€äº›è¿‡ç¨‹.</p><hr><h3 id="ReactDOM-render-çš„è°ƒç”¨æ ˆ"><a href="#ReactDOM-render-çš„è°ƒç”¨æ ˆ" class="headerlink" title="ReactDOM.render()çš„è°ƒç”¨æ ˆ"></a><code>ReactDOM.render()çš„è°ƒç”¨æ ˆ</code></h3><p>ä¸ºäº†æ›´å¥½çš„èƒ½å¤Ÿç†è§£è¿™ä¸€ç« çš„å†…å®¹, ä¸Šä¸€ç¯‡å·²ç»é€šè¿‡äº†<code>ReactCompositeComponent</code>åšäº†ä¸€è½®é“ºå«, åœ¨æœ‰äº†ä¸Šä¸€ç¯‡çš„çŸ¥è¯†çš„åŸºç¡€ä¸Š, æœ¬ç¯‡å†…å®¹çš„å¤æ‚åº¦å°†ä¼šå¤§å¤§é™ä½.</p><div class="tip"><br>æ‰€æœ‰å†…å®¹å‡å»ºç«‹åœ¨æ²¡æœ‰å¯åŠ¨<code>ServerSideRendering</code>çš„æƒ…å†µä¹‹ä¸‹.<br></div><h4 id="é€šè¿‡æ–‡å­—æ¥æè¿°"><a href="#é€šè¿‡æ–‡å­—æ¥æè¿°" class="headerlink" title="é€šè¿‡æ–‡å­—æ¥æè¿°:"></a>é€šè¿‡æ–‡å­—æ¥æè¿°:</h4><ol><li><code>render</code>æ–¹æ³•é¦–å…ˆä¼šè°ƒç”¨<code>_renderSubtreeIntoContainer</code>æ¥å¯åŠ¨è°ƒç”¨è¿‡ç¨‹, è¯¥æ–¹æ³•ä¼šè°ƒç”¨<code>_renderNewRootComponent</code>æ–¹æ³•. å¹¶ä¸”ä¼šè°ƒç”¨<code>render</code>ä¼ å…¥çš„callbackæ–¹æ³•.</li><li><code>_renderNewRootComponent</code>ä¼šè°ƒç”¨<code>instantiateReactComponent()</code>æ–¹æ³•æ¥å®ä¾‹åŒ–è¢«ä¼ å…¥çš„ç»„ä»¶. ç„¶åå¾—åˆ°å¯¹åº”çš„ç»„ä»¶æ ‘.</li><li>æŠŠå¾—åˆ°çš„ç»„ä»¶æ ‘é€šè¿‡<code>ReactUpdates.batchedUpdates</code>æ›´æ–°åˆ°DOMä¸­.<br>i. <code>ReactUpdates.batchedUpdates</code>ä¼šé€šè¿‡è°ƒç”¨<code>batchingStrategy.batchedUpdates</code>æ¥è°ƒç”¨<code>batchedMountComponentIntoNode</code>æ–¹æ³•. è¿™é‡Œæœ‰å…³äº<strong><u>ReactTransaction</u></strong>çš„æ¦‚å¿µ, åœ¨åé¢ä¸€ç« é‡Œé¢ä¼šè®²åˆ°.<br>ii. è¿™è¾¹éœ€è¦å…³æ³¨çš„æ–¹æ³•å°±æ˜¯<code>batchedMountComponentIntoNode</code>æ–¹æ³•.</li><li><code>batchedMountComponentIntoNode</code>è°ƒç”¨<code>mountComponentIntoNode</code>, ç„¶åç´§æ¥ç€<code>ReactReconciler.mountComponen</code>è¢«è°ƒç”¨. åˆ°è¿™é‡Œå¼€å§‹å°±æ˜¯ä¸Šä¸€ç« è®²è¿‡çš„é‚£ä¸€éƒ¨åˆ†å†…å®¹äº†. å®ä¾‹å†…éƒ¨çš„ç”Ÿå‘½å‘¨æœŸè¢«è°ƒç”¨, ç„¶åè¿”å›äº†å¯¹åº”çš„DOMç»“æ„.</li><li>è¿”å›çš„DOMç»“æ„è¢«é€šè¿‡<code>ReactMount._mountImageIntoNode</code>æ–¹æ³•æŒ‚è½½è¿›å…¥çœŸæ­£çš„DOMä¸­.</li><li>è‡³æ­¤, æ•´ä¸ªè°ƒç”¨è¿‡ç¨‹ç»“æŸ.</li></ol><h4 id="é€šè¿‡ä¸€å¼ æµç¨‹å›¾æ¥æè¿°"><a href="#é€šè¿‡ä¸€å¼ æµç¨‹å›¾æ¥æè¿°" class="headerlink" title="é€šè¿‡ä¸€å¼ æµç¨‹å›¾æ¥æè¿°:"></a>é€šè¿‡ä¸€å¼ æµç¨‹å›¾æ¥æè¿°:</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">â†“: è¡¨ç¤ºè°ƒç”¨</span><br><span class="line"><span class="code">            å¼€å§‹</span></span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">   ReactMount.render</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">ReactMount._renderSubtreeIntoContainer</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">ReactMount._renderNewRootComponent // è§¦å‘åˆ›å»ºçœŸå®DOMèŠ‚ç‚¹</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">instantiateReactComponent  // åˆ›å»ºçœŸå®DOM</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">batchedMountComponentIntoNode</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">mountComponentIntoNode</span><br><span class="line"><span class="code">             â†“ </span></span><br><span class="line">ReactReconciler.mountComponent</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">ReactCompositeComponent.mountComponent</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">ReactCompositeComponent.performInitialMount</span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line">ReactMount._mountImageIntoNode     </span><br><span class="line"><span class="code">             â†“\</span></span><br><span class="line"><span class="code">        setInnerHTML |----  é€šè¿‡æ ¹èŠ‚ç‚¹æŒ‚è½½</span></span><br><span class="line"><span class="code">             â†“/</span></span><br><span class="line">ReactDOMComponentTree.precacheNode    // ä¿å­˜virtualDOM </span><br><span class="line"><span class="code">             â†“</span></span><br><span class="line"><span class="code">            ç»“æŸ</span></span><br></pre></td></tr></table></figure><h4 id="é€šè¿‡ä¸€å¼ å…³ç³»å›¾æ¥æè¿°"><a href="#é€šè¿‡ä¸€å¼ å…³ç³»å›¾æ¥æè¿°" class="headerlink" title="é€šè¿‡ä¸€å¼ å…³ç³»å›¾æ¥æè¿°"></a>é€šè¿‡ä¸€å¼ å…³ç³»å›¾æ¥æè¿°</h4><img src="/2018/07/22/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.5-ReactDOM-renderå¹²äº†å•¥/render.png" title="render"><hr><h3 id="å°ç»“-amp-é¢„å‘Š"><a href="#å°ç»“-amp-é¢„å‘Š" class="headerlink" title="å°ç»“&amp;é¢„å‘Š:"></a>å°ç»“&amp;é¢„å‘Š:</h3><p>é€šè¿‡äº†è§£æ¡†æ¶ä¸­å°è£…çš„æ–¹æ³•å†…éƒ¨çš„è°ƒç”¨å®ç°, å¯ä»¥æ›´ç›´è§‚çš„å»äº†è§£æ¡†æ¶, èƒ½å¤Ÿåœ¨åç»­çš„å·¥ä½œå½“ä¸­è®©è‡ªå·±å†™å‡ºæ¥æ€§èƒ½æ›´åŠ é«˜çš„ä»£ç , å¹¶ä¸”å¯¹æ•´ä½“åº”ç”¨èƒ½æœ‰æ‰€è§„åˆ’. </p><p><strong>ä¸‹æœŸé¢„å‘Š: Reactç”Ÿå‘½å‘¨æœŸçš„å…·ä½“åˆ†æ.</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;ReactDOM.render&lt;/code&gt; &lt;code&gt;è°ƒç”¨æ ˆ&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Reactåº”ç”¨çš„å¯åŠ¨å¯è°“æ˜¯ç›¸å½“ç®€å•äº†, æ— éœ€è¿‡å¤šçš„é…ç½®, åªéœ€è¦ä¸‰è¡Œä»£ç ä¾¿å¯ä»¥å¯åŠ¨&lt;/p&gt;
&lt;figure class=&quot;highlight jsx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; React &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &amp;#123;render&amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react-dom&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;render((&lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;å¯åŠ¨!&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;), &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelector(&lt;span class=&quot;string&quot;&gt;&#39;#root&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ—-Â§1.4-æ¥äºº, ç»™æˆ‘newä¸€ä¸‹</title>
    <link href="https://jeremywu.info/2018/07/21/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A71.4-%E6%9D%A5%E4%BA%BA-%E7%BB%99%E6%88%91new%E4%B8%80%E4%B8%8B/"/>
    <id>https://jeremywu.info/2018/07/21/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.4-æ¥äºº-ç»™æˆ‘newä¸€ä¸‹/</id>
    <published>2018-07-21T13:22:56.000Z</published>
    <updated>2018-07-26T13:44:50.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>ReactCompositeComponent</code> <code>instantiate</code></p><h3 id="è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶"><a href="#è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶" class="headerlink" title="è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶"></a>è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶</h3><p><a href="/2018/07/20/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.3å…ˆç»™æˆ‘æ•´ä¸€ä¸ªComponent/">ä¸Šä¸€ç« </a>è®²åˆ°äº†, Reactçš„<code>Component</code>ç§ç±», ä½†æ²¡è®²åˆ°ç”¨æˆ·è‡ªå·±å†™çš„<code>CustomComponent</code>æ˜¯æ€ä¹ˆè¢«å®ä¾‹åŒ–çš„. åœ¨åé¢çš„ç« èŠ‚ä¼šä»‹ç»åˆ°å…³äºåº”ç”¨å¯åŠ¨çš„è¿‡ç¨‹åˆ°åº•å‘ç”Ÿäº†å“ªäº›äº‹æƒ…, åœ¨è¿™è¾¹å°±å…ˆç®€å•çš„åšä¸€ä¸ªé“ºå«. ä¸»è¦å…³æ³¨åœ¨<code>CustomComponent</code>çš„å®ä¾‹åŒ–è¿‡ç¨‹.</p><a id="more"></a><p>å½“æˆ‘ä»¬è°ƒç”¨<code>React.render(...)</code>æ–¹æ³•çš„æ—¶å€™, ä¼šè°ƒç”¨<a href="https://github.com/facebook/react/blob/v15.6.2/src/renderers/shared/stack/reconciler/instantiateReactComponent.js" target="_blank" rel="noopener">ReactMount.js</a>ä¸­çš„<code>instantiateReactComponent</code>æ–¹æ³•, è¯¥æ–¹æ³•ä¸­æ¶‰åŠåˆ°å®ä¾‹åŒ–ä¸€ä¸ª<code>CustomComponent</code>çš„ä»£ç ä¸º:<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">instantiateReactComponent</span>(<span class="params">node, shouldHaveDebugID</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> instance;</span><br><span class="line">  <span class="keyword">var</span> element = node;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> element.type === <span class="string">'string'</span>) &#123;</span><br><span class="line">        instance = ReactHostComponent.createInternalComponent(element);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isInternalComponentType(element.type)) &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> element.type(element);</span><br><span class="line">        <span class="keyword">if</span> (!instance.getHostNode) &#123;</span><br><span class="line">          instance.getHostNode = instance.getNativeNode;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> ReactCompositeComponentWrapper(element);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> node === <span class="string">'string'</span> || <span class="keyword">typeof</span> node === <span class="string">'number'</span>) &#123;</span><br><span class="line">        instance = ReactHostComponent.createInstanceForText(node);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Encountered invalid React node of type "</span> + <span class="keyword">typeof</span> node );</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>å…³é”®çš„ä¸€è¡Œä»£ç åœ¨æ­¤å¤„:<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">instance = <span class="keyword">new</span> ReactCompositeComponentWrapper(element);</span><br></pre></td></tr></table></figure></p><p>å…³é”®è§’è‰²<code>ReactCompositeComponentWrapper</code>æ˜¯å¹²ä»€ä¹ˆçš„å‘¢? åˆå’Œæˆ‘ä»¬æåˆ°çš„<code>ReactCompositeComponent</code>æœ‰ä»€ä¹ˆçº ç¼ ä¸æ¸…çš„å…³ç³»å‘¢? ä¸‹é¢å‡ è¡Œä»£ç å°±å¯ä»¥å‘Šè¯‰ä½ äº‹æƒ…çš„çœŸç›¸:<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ReactCompositeComponentWrapper = <span class="function"><span class="keyword">function</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.construct(element);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Object</span>.assign(</span><br><span class="line">  ReactCompositeComponentWrapper.prototype,</span><br><span class="line">  ReactCompositeComponent,</span><br><span class="line">  &#123;</span><br><span class="line">    _instantiateReactComponent: instantiateReactComponent,</span><br><span class="line">  &#125;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p><code>ReactCompositeComponentWrapper</code>å°±è·Ÿä»–çš„åå­—ä¸€æ ·, æ˜¯å¯¹<code>ReactCompositeComponent</code>è¿™ä¸ªç±»çš„ä¸€ä¸ªåŒ…è£…ç±», æ‰€æœ‰çš„ç±»æ–¹æ³•éƒ½æ¥è‡ªäºæˆ‘ä»¬ä»Šå¤©è¦è¯´åˆ°çš„ä¸»è§’<code>ReactCompositeComponent</code>.</p><hr><h3 id="ReactCompositeComponent"><a href="#ReactCompositeComponent" class="headerlink" title="ReactCompositeComponent"></a><code>ReactCompositeComponent</code></h3><p>æºç åœ°å€: <a href="https://github.com/facebook/react/blob/v15.6.2/src/renderers/shared/stack/reconciler/ReactCompositeComponent.js" target="_blank" rel="noopener">ReactCompositeComponent.js</a></p><p>ä¸‹é¢æ¥ç€å¯¹<code>ReactCompositeComponent</code>åšä¸€ä¸‹åˆ†æ, æŸäº›æ–¹æ³•çš„å…·ä½“å†…å®¹ä¼šçœç•¥æ‰, å¦‚æœæœ‰éœ€è¦å¯ä»¥è‡ªè¡ŒæŸ¥é˜…æºç å½“ä¸­çš„å…·ä½“ä»£ç , æ–¹ä¾¿èŠ‚çœç¯‡å¹…ä»¥åŠæ›´æ˜“äºé˜…è¯».<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ReactCompositeComponent = &#123;</span><br><span class="line">  construct: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;, <span class="comment">// ç”¨äºåˆå§‹åŒ–ç»„ä»¶çš„å…ƒä¿¡æ¯(Metadata)</span></span><br><span class="line">  mountComponent: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> inst = <span class="keyword">this</span>._constructComponent(...); <span class="comment">// ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„å¯åŠ¨å…¥å£,</span></span><br><span class="line">    <span class="keyword">var</span> markup; <span class="comment">// renderæ–¹æ³•è¿”å›çš„ReactElementå°±æ˜¯è¿™ä¸ªmarkup</span></span><br><span class="line">    markup = performInitialMount(...);</span><br><span class="line">    <span class="keyword">if</span> (inst.componentDidMount) inst.componentDidMount(); <span class="comment">// ç¬¬ä¸‰ä¸ªé’©å­å‡½æ•°è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">return</span> markup;</span><br><span class="line">  &#125;,</span><br><span class="line">  _constructComponent: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;, <span class="comment">// è¿™ä¸ªæ–¹æ³•ä¼šè°ƒç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">  _constructComponentWithoutOwner: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Component(publicProps, publicContext, updateQueue); <span class="comment">// è¢«åŒ…èµ·æ¥çš„Componentè¢«å®ä¾‹åŒ–</span></span><br><span class="line">  &#125;,</span><br><span class="line">  performInitialMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ins = <span class="keyword">this</span>._instance;</span><br><span class="line">    <span class="keyword">if</span> (ins.componentWillMount) ins.componentWillMount(); <span class="comment">// ç¬¬ä¸€ä¸ªé’©å­å‡½æ•°çš„è°ƒç”¨</span></span><br><span class="line">    <span class="comment">// æ¯”è¾ƒé‡è¦çš„åœ°æ–¹: å½“åœ¨åˆå§‹æŒ‚è½½çš„é˜¶æ®µå¦‚æœæœ‰å‘ç°`setState`æ–¹æ³•è¢«è°ƒç”¨, ä¾¿ä¼šé€šè¿‡åŒæ­¥çš„æ–¹å¼æ¥å¤„ç†, å¾ˆå¥½çš„é¿å…äº†setStateå¯¼è‡´çš„é‡æ–°æ¸²æŸ“, æ¥æé«˜æ•´ä½“çš„æ€§èƒ½.</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>._pendingStateQueue) &#123;</span><br><span class="line">      inst.state = <span class="keyword">this</span>._processPendingState(inst.props, inst.context);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (renderedElement === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="comment">// è¿‘ä¼¼ç­‰äº: renderedElement = this._instance.render();</span></span><br><span class="line">      renderedElement = <span class="keyword">this</span>._renderValidatedComponent();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> child = <span class="keyword">this</span>._instantiateReactComponent(...) <span class="comment">// é€’å½’å®ä¾‹åŒ–å­ç»„ä»¶</span></span><br><span class="line">    <span class="keyword">var</span> markup = ReactReconciler.mountComponent(child, ...); <span class="comment">// é€’å½’å¾—åˆ°å®Œæ•´çš„æ ‘.</span></span><br><span class="line">    <span class="keyword">return</span> markup;</span><br><span class="line">  &#125;,</span><br><span class="line">  _renderValidatedComponent: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._renderValidatedComponentWithoutOwnerOrContext();</span><br><span class="line">  &#125;,</span><br><span class="line">  _renderValidatedComponentWithoutOwnerOrContext: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._instance.render(); <span class="comment">// ç¬¬äºŒä¸ªé’©å­çš„è°ƒç”¨</span></span><br><span class="line">  &#125;,</span><br><span class="line">  receiveComponent: <span class="function"><span class="keyword">function</span>(<span class="params">...</span>) </span>&#123; <span class="comment">// è°ƒç”¨è¯¥æ–¹æ³•æ¥æ›´æ–°Component</span></span><br><span class="line">    <span class="keyword">this</span>.updateComponent(...); </span><br><span class="line">  &#125;,</span><br><span class="line">  updateComponent: <span class="function"><span class="keyword">function</span>(<span class="params">...</span>) </span>&#123; <span class="comment">// åé¢ä¼šè®²åˆ°è¿™äº›æ›´æ–°æ¡ä»¶å¦‚ä½•è¢«æ»¡è¶³</span></span><br><span class="line">    <span class="keyword">if</span> (willReceive &amp;&amp; inst.componentWillReceiveProps) &#123;</span><br><span class="line">      inst.componentWillReceiveProps(); <span class="comment">// ç¬¬å››ä¸ªé’©å­å‡½æ•°çš„è°ƒç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> shouldUpdate = inst.shouldComponentUpdate(); <span class="comment">// ç¬¬äº”ä¸ªé’©å­å‡½æ•°è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (shouldUpdate) <span class="keyword">this</span>._performComponentUpdate();</span><br><span class="line">  &#125;,</span><br><span class="line">  _performComponentUpdate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    inst.componentWillUpdate(...); <span class="comment">// ç¬¬å…­ä¸ªé’©å­å‡½æ•°çš„è°ƒç”¨.</span></span><br><span class="line">    <span class="keyword">this</span>._updateRenderedComponent(...); <span class="comment">// æ›´æ–°; å†…éƒ¨è°ƒç”¨ç¬¬ä¸ƒä¸ªé’©å­å‡½æ•° Component.render();</span></span><br><span class="line">    inst.componentDidUpdate &amp;&amp; inst.componentDidUpdate(); <span class="comment">// ç¬¬å…«ä¸ªä¸ªé’©å­å‡½æ•°è°ƒç”¨</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// é‡Œé¢æ˜¯Componentæ›´æ–°çš„æ“ä½œ ç®€å•æ¥è¯´å°±æ˜¯é”€æ¯æ‰åŸæœ‰çš„èŠ‚ç‚¹, ç„¶åé‡æ–°å®ä¾‹åŒ–æ–°çš„èŠ‚ç‚¹æŒ‚è½½.</span></span><br><span class="line">  _updateRenderedComponent: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; &#125;,</span><br><span class="line">  unmountComponent: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; &#125; <span class="comment">// é€’å½’å¸è½½èŠ‚ç‚¹, è°ƒç”¨å­èŠ‚ç‚¹çš„ componentWillUnmountæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h4 id="æœ¬ç« å°ç»“"><a href="#æœ¬ç« å°ç»“" class="headerlink" title="æœ¬ç« å°ç»“:"></a>æœ¬ç« å°ç»“:</h4><p><code>ReactCompositeComponent</code> çš„å†…å®¹åŸºæœ¬å°±æ˜¯æŒ‚è½½/æ›´æ–°/å¸è½½ç­‰æ“ä½œ. é™¤äº†<code>CompositeComponent</code>, åœ¨<code>instantiateReactComponent</code>æ–¹æ³•ä¸­, èƒ½å¤Ÿçœ‹åˆ°Reactä¸­ä¸€å…±æœ‰4ç§Componentç±»å‹.</p><ol><li>ReactCompositeComponent<ul><li>InternalComponent. <code>// å¯ä»¥ç†è§£ä¸ºReactçš„å®˜æ–¹æ ‡å‡†ç»„ä»¶åº“</code></li><li>UserDefinedComponent <code>// ç”¨æˆ·è‡ªå®šä¹‰</code></li></ul></li><li>ReactDOMComponent <code>// DOMèŠ‚ç‚¹ç›¸å…³çš„Component, è‡ªå®šä¹‰çš„Componentæœ€åéƒ½ä¼šè¢«å¤„ç†æˆè¯¥ç±»å‹çš„</code></li><li>ReactTextComponent <code>// å­—é¢é‡èŠ‚ç‚¹, å¦‚ &quot;Some string&quot; &quot;12312&quot;</code></li><li>ReactEmptyComponent <code>// ç©ºèŠ‚ç‚¹</code></li></ol><hr><h4 id="ä¸‹æœŸé¢„å‘Š-ä»React-render-çš„è°ƒç”¨å¼€å§‹-åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#ä¸‹æœŸé¢„å‘Š-ä»React-render-çš„è°ƒç”¨å¼€å§‹-åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="ä¸‹æœŸé¢„å‘Š: ä»React.render()çš„è°ƒç”¨å¼€å§‹, åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ?"></a>ä¸‹æœŸé¢„å‘Š: ä»<code>React.render()</code>çš„è°ƒç”¨å¼€å§‹, åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ?</h4>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;ReactCompositeComponent&lt;/code&gt; &lt;code&gt;instantiate&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶&quot;&gt;&lt;a href=&quot;#è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶&quot; class=&quot;headerlink&quot; title=&quot;è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶&quot;&gt;&lt;/a&gt;è®©æˆ‘ä»¬å…ˆå®ä¾‹åŒ–ä¸€ä¸ªç»„ä»¶&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;/2018/07/20/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.3å…ˆç»™æˆ‘æ•´ä¸€ä¸ªComponent/&quot;&gt;ä¸Šä¸€ç« &lt;/a&gt;è®²åˆ°äº†, Reactçš„&lt;code&gt;Component&lt;/code&gt;ç§ç±», ä½†æ²¡è®²åˆ°ç”¨æˆ·è‡ªå·±å†™çš„&lt;code&gt;CustomComponent&lt;/code&gt;æ˜¯æ€ä¹ˆè¢«å®ä¾‹åŒ–çš„. åœ¨åé¢çš„ç« èŠ‚ä¼šä»‹ç»åˆ°å…³äºåº”ç”¨å¯åŠ¨çš„è¿‡ç¨‹åˆ°åº•å‘ç”Ÿäº†å“ªäº›äº‹æƒ…, åœ¨è¿™è¾¹å°±å…ˆç®€å•çš„åšä¸€ä¸ªé“ºå«. ä¸»è¦å…³æ³¨åœ¨&lt;code&gt;CustomComponent&lt;/code&gt;çš„å®ä¾‹åŒ–è¿‡ç¨‹.&lt;/p&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ— - Â§1.3 å…ˆç»™æˆ‘æ•´ä¸€ä¸ª Component</title>
    <link href="https://jeremywu.info/2018/07/20/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A71.3%E5%85%88%E7%BB%99%E6%88%91%E6%95%B4%E4%B8%80%E4%B8%AAComponent/"/>
    <id>https://jeremywu.info/2018/07/20/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.3å…ˆç»™æˆ‘æ•´ä¸€ä¸ªComponent/</id>
    <published>2018-07-20T13:43:41.000Z</published>
    <updated>2018-07-20T17:35:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®å­—: </strong> <code>BaseComponent</code> <code>CustomComponent</code> <code>PureComponent</code> <code>Statelesscomponent</code></p><p>ä¸Šå›ä¹¦è¯´é“, æ‰€æœ‰äººå†™çš„JSX(TSX)ä»£ç , éƒ½ä¼šè¢«å¯¹åº”çš„ç¼–è¯‘å™¨ç»™ç¿»è¯‘æˆ<code>React.createElement</code>å½¢å¼çš„ä»£ç .<br>é‚£ä¹ˆ, ä¸€ä¸ª<code>CustomdComponent</code>æ˜¯æ€ä¹ˆæ ·è¢«Reactæ¸²æŸ“çš„å‘¢?</p><h4 id="æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent"><a href="#æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent" class="headerlink" title="æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent"></a>æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent</h4><a id="more"></a><hr><p>åœ¨å¼€å§‹ä¹‹å‰, å…ˆè¦å…¬å¸ƒä¸€ä¸‹<a href="/2018/07/18/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.2å…ˆæœ‰èŠ‚ç‚¹åæœ‰å¤©%20ReactCreateElement/">ä¸Šä¸€ç¯‡</a>æ–‡ç« çš„ç»ƒä¹ é¢˜ç­”æ¡ˆ.</p><p>ç¼–è¯‘åä»£ç å¦‚ä¸‹:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render = <span class="function"><span class="params">()</span> =&gt;</span> React.createElement(</span><br><span class="line">                      <span class="string">'div'</span>, <span class="comment">// type</span></span><br><span class="line">                      &#123;<span class="attr">className</span>: <span class="string">'container'</span>&#125;, <span class="comment">// props</span></span><br><span class="line">                      React.createElement(            <span class="comment">//  - |</span></span><br><span class="line">                        <span class="string">'span'</span>,   <span class="comment">//type              //    |--&gt; children</span></span><br><span class="line">                        &#123;<span class="attr">className</span>: <span class="string">'sub'</span>&#125;, <span class="comment">// props  //  - |</span></span><br><span class="line">                        <span class="literal">null</span>) <span class="comment">// children</span></span><br><span class="line">                      );</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢çš„æ–¹æ³•è¿è¡Œå‡ºæ¥çš„ç»“æœä¸º: </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  $$<span class="keyword">typeof</span>: <span class="built_in">Symbol</span>.for(<span class="string">'react.element'</span>)</span><br><span class="line">  type: <span class="string">'div'</span>,</span><br><span class="line">  key: <span class="literal">null</span>,</span><br><span class="line">  ref: <span class="literal">null</span>,</span><br><span class="line">  props: &#123;</span><br><span class="line">    className: <span class="string">'container'</span>,</span><br><span class="line">    children: &#123;</span><br><span class="line">      $$<span class="keyword">typeof</span>: <span class="built_in">Symbol</span>.for(<span class="string">'react.element'</span>)</span><br><span class="line">      type: <span class="string">'span'</span>,</span><br><span class="line">      key: <span class="literal">null</span>,</span><br><span class="line">      ref: <span class="literal">null</span>,</span><br><span class="line">      props: &#123;</span><br><span class="line">        className: <span class="string">'sub'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      _owner: <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  _owner: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>&emsp;&emsp;&nbsp;åœ¨<strong>ES6</strong> A.K.A. <a href="https://www.ecma-international.org/ecma-262/6.0/" target="_blank" rel="noopener">ECMAScript2015Â®</a>ä»¥åŠæ›´é«˜ç‰ˆæœ¬çš„<a href="https://www.ecma-international.org/publications/standards/Ecma-262.htm" target="_blank" rel="noopener">ECMAScriptÂ®</a>è¶Šæ¥è¶Šæ™®åŠçš„ä»Šå¤©, å¹¶ä¸”å„ç§è¶…é›†(Superset)/ä¸‹ä¸€ä»£ç¼–è¯‘å™¨(Next Gen Compiler)å¦‚: <a href="https://www.typescriptlang.org/" target="_blank" rel="noopener">TypescriptÂ®</a>, <a href="http://babeljs.io/" target="_blank" rel="noopener">BabelÂ®</a>çš„æ™®åŠ, æˆ‘ä»¬æ›´å¤šçš„æ˜¯åˆ©ç”¨<code>class</code>è¯­æ³•æ¥å®šä¹‰æˆ‘ä»¬çš„<code>ReactComponent</code>, è€Œéæ—©æœŸç‰ˆæœ¬çš„<code>React.createClass</code>, ä¸”<code>React.createClass</code>åœ¨16.0+ç‰ˆæœ¬å°±å·²ç»è¢«å®£å¸ƒåºŸå¼ƒ, æ‰€ä»¥åœ¨è¿™è¾¹å°±åªå¯¹å®˜æ–¹æä¾›çš„ä¸‰ç§Component:<br>&emsp;&emsp;&nbsp;&nbsp;i. <code>Component</code> ä¹Ÿå« <code>BaseComponent</code><br>&emsp;&emsp;&nbsp;ii. <code>PureComponent</code><br>&emsp;&emsp;iii. <code>StatelessComponent</code> ä¹Ÿå« <code>FunctionalComponent</code><br>åšä¸€ä¸ªç®€å•çš„åˆ†æ.</p><h4 id="i-BaseComponent"><a href="#i-BaseComponent" class="headerlink" title="i. BaseComponent"></a>i. BaseComponent</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ReactComponent</span>(<span class="params">props, context, updater</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.props = props;</span><br><span class="line">  <span class="keyword">this</span>.context = context;</span><br><span class="line">  <span class="keyword">this</span>.refs = emptyObject;</span><br><span class="line">  <span class="keyword">this</span>.updater = updater || ReactNoopUpdateQueue;</span><br><span class="line">&#125;</span><br><span class="line">ReactComponent.prototype.isReactComponent = &#123;&#125;;</span><br><span class="line">ReactComponent.prototype.setState = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// ...çœç•¥å®ç°, åé¢ä¼šä¸“é—¨è®²è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">ReactComponent.prototype.forceUpdate = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;; <span class="comment">//.. åŒä¸Š</span></span><br></pre></td></tr></table></figure><h4 id="ii-PureComponent"><a href="#ii-PureComponent" class="headerlink" title="ii. PureComponent"></a>ii. PureComponent</h4><p><code>PureComponent</code>å…¶å®åŸºæœ¬ä¸Šè·Ÿ<code>ReactComponent</code>ç­‰ä»·, å”¯ä¸€ä¸åŒçš„åœ°æ–¹åœ¨è¿™æ®µä»£ç , è€Œä¸åŒç‚¹å°†ä¼šåœ¨åé¢çš„æ–‡ç« å½“ä¸­å¯¹å…¶è¿›è¡Œä»‹ç».<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ReactPureComponent.prototype.isPureReactComponent = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure></p><h4 id="iii-StatelessComponent"><a href="#iii-StatelessComponent" class="headerlink" title="iii. StatelessComponent"></a>iii. StatelessComponent</h4><p><code>StatelessComponent</code>è¾ƒå‰ä¸¤è€…è€Œè¨€ç”±äºä¸æä¾›ä»»ä½•çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°, åœ¨ç‰¹å®šæƒ…å†µä¸‹çš„æ€§èƒ½ä¹Ÿè®¸ä¼šæ¯”å‰ä¸¤è€…ç¨å¾®å¥½ä¸€ç‚¹. å…¶æ›´å¤§çš„ä¼˜åŠ¿æ˜¯åœ¨äº, ç®€åŒ–äº†<code>Component</code>æœ¬èº«çš„ä¸€ä¸ªæŠ½è±¡è¿‡ç¨‹, å¯ä»¥å‡å°‘éå¸¸å¤šçš„ä»£ç é‡.</p><p>ä»¥ä¸Šæ˜¯Reactç³»ç»Ÿä¸­ç”¨æˆ·å¯è‡ªå®šä¹‰çš„ä¸‰ç§<code>Component</code>. è¿™ä¸‰è€…å…¶å®å¹¶æ²¡æœ‰å®é™…å®šä¹‰æ‰€è°“çš„ç”Ÿå‘½å‘¨æœŸç­‰å‡½æ•°. è¯¦æƒ…è¯·è§ä¸‹å›åˆ†è§£.</p><hr><h4 id="ä¸‹æœŸé¢„å‘Š-ReactCompositeComponent"><a href="#ä¸‹æœŸé¢„å‘Š-ReactCompositeComponent" class="headerlink" title="ä¸‹æœŸé¢„å‘Š: ReactCompositeComponent"></a>ä¸‹æœŸé¢„å‘Š: <code>ReactCompositeComponent</code></h4>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®å­—: &lt;/strong&gt; &lt;code&gt;BaseComponent&lt;/code&gt; &lt;code&gt;CustomComponent&lt;/code&gt; &lt;code&gt;PureComponent&lt;/code&gt; &lt;code&gt;Statelesscomponent&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›ä¹¦è¯´é“, æ‰€æœ‰äººå†™çš„JSX(TSX)ä»£ç , éƒ½ä¼šè¢«å¯¹åº”çš„ç¼–è¯‘å™¨ç»™ç¿»è¯‘æˆ&lt;code&gt;React.createElement&lt;/code&gt;å½¢å¼çš„ä»£ç .&lt;br&gt;é‚£ä¹ˆ, ä¸€ä¸ª&lt;code&gt;CustomdComponent&lt;/code&gt;æ˜¯æ€ä¹ˆæ ·è¢«Reactæ¸²æŸ“çš„å‘¢?&lt;/p&gt;
&lt;h4 id=&quot;æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent&quot;&gt;&lt;a href=&quot;#æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent&quot; class=&quot;headerlink&quot; title=&quot;æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent&quot;&gt;&lt;/a&gt;æ¥æ•´æ‡‚å˜›æ˜¯ä¸€ä¸ªReactComponent&lt;/h4&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ— - Â§1.2å…ˆæœ‰èŠ‚ç‚¹åæœ‰å¤© ReactCreateElement</title>
    <link href="https://jeremywu.info/2018/07/18/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A71.2%E5%85%88%E6%9C%89%E8%8A%82%E7%82%B9%E5%90%8E%E6%9C%89%E5%A4%A9%20ReactCreateElement/"/>
    <id>https://jeremywu.info/2018/07/18/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.2å…ˆæœ‰èŠ‚ç‚¹åæœ‰å¤© ReactCreateElement/</id>
    <published>2018-07-18T14:18:17.000Z</published>
    <updated>2018-07-20T16:11:23.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®è¯:</strong> <code>ReactElement</code> <code>JSX</code></p><h3 id="ä¸€åˆ‡éƒ½è¦ä»ReactDOM-renderè®²èµ·"><a href="#ä¸€åˆ‡éƒ½è¦ä»ReactDOM-renderè®²èµ·" class="headerlink" title="ä¸€åˆ‡éƒ½è¦ä»ReactDOM.renderè®²èµ·"></a>ä¸€åˆ‡éƒ½è¦ä»ReactDOM.renderè®²èµ·</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> ReactDom <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> Example <span class="keyword">from</span> <span class="string">'example'</span>;</span><br><span class="line">ReactDOM.render(&lt;Example/&gt;, <span class="built_in">document</span>.querySelector(<span class="string">'#root'</span>));</span><br></pre></td></tr></table></figure><a id="more"></a><hr><h4 id="ä»ä¸€ä¸ªé”™è¯¯è¯´èµ·"><a href="#ä»ä¸€ä¸ªé”™è¯¯è¯´èµ·" class="headerlink" title="ä»ä¸€ä¸ªé”™è¯¯è¯´èµ·"></a>ä»ä¸€ä¸ªé”™è¯¯è¯´èµ·</h4><p>ç›¸ä¿¡ä¸å°‘çš„äººéƒ½çŠ¯è¿‡è¿™æ ·ä¸€ä¸ªé”™è¯¯:<br><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">SomeComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123; </span><br><span class="line">  </span><br><span class="line">  render() &#123;  </span><br><span class="line">    <span class="keyword">return</span> &lt;div&gt;Example&lt;/div&gt;;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Error</span>: React is not defined.</span><br></pre></td></tr></table></figure></p><p>æ˜æ˜æˆ‘è¿™é‡Œå¹¶æ²¡æœ‰ç”¨åˆ°<code>React</code>è¿™ä¸ªå…³é”®å­—ä¸ºä»€ä¹ˆä¼šå‘Šè¯‰æˆ‘è¯´<code>React is not defined</code>å‘¢?</p><p>&emsp;&emsp;&nbsp;ç­”æ¡ˆå°±æ˜¯å½“ä½ å†™JSXçš„ä»£ç æ—¶, éƒ½æ˜¯éœ€è¦é€šè¿‡æˆ‘ä»¬çš„ä¸€äº›ç¼–è¯‘å·¥å…·æŠŠJSXä»£ç ç¼–è¯‘æˆJavaScriptä»£ç , è¿™æ ·æµè§ˆå™¨æ‰èƒ½å¤Ÿè¿è¡Œ. è€Œè¿™é‡Œçš„ç¼–è¯‘è¿‡ç¨‹æ­£å¥½æ˜¯ç”¨åˆ°äº†<code>React</code>è¿™ä¸ªåº“ä¸Šæ‰€æä¾›çš„<code>createElement</code>æ–¹æ³•, æ‰€ä»¥æ‰ä¼šæœ‰ä¸Šé¢è¿™ä¸€è¡Œé”™è¯¯.</p><p>ä¸Šé¢çš„ä»£ç ç­‰åŒäº:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...çœç•¥</span></span><br><span class="line"><span class="keyword">class</span> SomeComponent <span class="keyword">extends</span> React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> React.createElement(<span class="string">'div'</span>, <span class="literal">null</span>); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...çœç•¥</span></span><br></pre></td></tr></table></figure><hr><h4 id="å…·ä½“åˆ†æcreateElementæ–¹æ³•åˆ°åº•æ˜¯å¹²äº†ä»€ä¹ˆ"><a href="#å…·ä½“åˆ†æcreateElementæ–¹æ³•åˆ°åº•æ˜¯å¹²äº†ä»€ä¹ˆ" class="headerlink" title="å…·ä½“åˆ†æcreateElementæ–¹æ³•åˆ°åº•æ˜¯å¹²äº†ä»€ä¹ˆ"></a>å…·ä½“åˆ†æ<code>createElement</code>æ–¹æ³•åˆ°åº•æ˜¯å¹²äº†ä»€ä¹ˆ</h4><p><code>createElement</code>æ–¹æ³•çš„æ–¹æ³•ç­¾å:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createElement</span>(<span class="params"><span class="keyword">type</span>, config, children</span>)</span>;</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th></tr></thead><tbody><tr><td>type</td><td><code>string</code> or <code>ReactCompositeComponent</code></td></tr><tr><td>config</td><td><code>any</code></td></tr><tr><td>children</td><td><code>any</code></td></tr><tr><td>è¿”å›å€¼</td><td><code>ReactElement</code></td></tr></tbody></table><p>ä»å‡½æ•°ç­¾åä¸Šå¯ä»¥ä¸éš¾çœ‹å‡º, åœ¨æ„é€ èŠ‚ç‚¹æ—¶, <code>React</code> æ˜¯éœ€è¦çŸ¥é“è¦æ„é€ çš„èŠ‚ç‚¹çš„<strong>ç±»å‹</strong>, èŠ‚ç‚¹éœ€è¦ç”¨åˆ°çš„ä¸€äº›<strong>å±æ€§å€¼</strong>, ä»¥åŠèŠ‚ç‚¹çš„<strong>å­èŠ‚ç‚¹</strong>, ç„¶åè¿”å›äº†ä¸€ä¸ª<code>ReactElement</code>å®ä½“.</p><div class="tip"><br>  æ³¨:&emsp;<strong>ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹ä¸Šçš„å­èŠ‚ç‚¹å¯ä»¥çœ‹åšè¯¥èŠ‚ç‚¹çš„å±æ€§å€¼(Property).</strong><br></div><p>æ¥ä¸‹æ¥è¿›å…¥æ–¹æ³•å†…éƒ¨, çœ‹è¿™ä¸ªæ–¹æ³•åˆ°åº•åšäº†ä¸€äº›ä»€ä¹ˆäº‹æƒ…, è¯¥æ–¹æ³•æœ€åè¿”å›çš„ç»“æœåˆæ˜¯ä»€ä¹ˆ, çœç•¥æ‰ä¸€éƒ¨åˆ†æ— å…³ç´§è¦çš„ä»£ç , æŸäº›ä»£ç æ ¼å¼ä¸ºäº†ç¯‡å¹…ç¨æœ‰æ•´æ”¹ä½†ä¸å½±å“æ­£ç¡®æ€§.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">React.createElement = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="keyword">type</span>, config, children</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> propName;</span><br><span class="line">  <span class="keyword">var</span> props = &#123;&#125;, key = ref = self = source = <span class="literal">null</span>;</span><br><span class="line">  <span class="comment">// ä¼ é€’å±æ€§</span></span><br><span class="line">  <span class="keyword">if</span> (config != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// å…³é”®å±æ€§, åé¢ä¼šåˆ†æåˆ°.</span></span><br><span class="line">    <span class="keyword">if</span> (hasValidRef(config)) &#123;</span><br><span class="line">      ref = config.ref;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦å…·æœ‰æœ‰æ•ˆçš„ç‰¹æ®Škey, keyå±æ€§ä¹Ÿæ˜¯èŠ‚ç‚¹çš„ä¿ç•™å±æ€§, ä¸ºReactçš„diffåšäº†éå¸¸å¤§çš„è´¡çŒ®</span></span><br><span class="line">    <span class="keyword">if</span> (hasValidKey(config)) &#123;</span><br><span class="line">      key = <span class="string">''</span> + config.key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    self = config.__self === <span class="literal">undefined</span> ? <span class="literal">null</span> : config.__self;</span><br><span class="line">    source = config.__source === <span class="literal">undefined</span> ? <span class="literal">null</span> : config.__source;</span><br><span class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> config) &#123;</span><br><span class="line">      <span class="comment">// ... çœç•¥å±æ€§çš„å¤åˆ¶</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æŠŠå­èŠ‚ç‚¹ä½œä¸ºå½“å‰æ ¹èŠ‚ç‚¹ä¸Šçš„å±æ€§</span></span><br><span class="line">  <span class="keyword">var</span> childrenLength = <span class="built_in">arguments</span>.length - <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> (childrenLength === <span class="number">1</span>) &#123;</span><br><span class="line">    props.children = children;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenLength &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// æ­¤å¤„ä»£ç ä¸ºæœ¬æ–‡ä½œè€…è°ƒæ•´ åŸå§‹ä»£ç å¯å‚è§æ–‡æœ«ç»™å‡ºåœ°å€</span></span><br><span class="line">    props.children = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>, <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¤„ç†æ ¹èŠ‚ç‚¹ä¸Šçš„é»˜è®¤çš„å±æ€§</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">type</span> &amp;&amp; <span class="keyword">type</span>.defaultProps) &#123;</span><br><span class="line">    <span class="comment">// ... çœç•¥é»˜è®¤å±æ€§çš„å¤åˆ¶</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¿”å›ä¸€ä¸ªReactElementèŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">return</span> ReactElement(<span class="keyword">type</span>, key, ref, self, source, ReactCurrentOwner.current, props);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>&emsp;&emsp;&nbsp;é€è¿‡è¿™ä¸ªæ–¹æ³•å…¶å®ä¸éš¾çœ‹å‡º, <code>React.createElement</code>æ•´ä¸ªæ–¹æ³•å†…éƒ¨, éƒ½æ˜¯åœ¨åšä¸€ç³»åˆ—çš„æ•°æ®å¤„ç†, ç„¶åæŠŠå¤„ç†å¥½çš„æ•°æ®è¾“å…¥ç»™<code>ReactElement</code>è¿™ä¸ªæ–¹æ³•, é€šè¿‡è¯¥æ–¹æ³•æ¥æ„é€ å‡ºä¸€ä¸ªçœŸæ­£çš„<code>ReactElement</code>èŠ‚ç‚¹.</p><hr><h5 id="ReactElementåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿"><a href="#ReactElementåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿" class="headerlink" title="ReactElementåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿?"></a><code>ReactElement</code>åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿?</h5><p>&emsp;&emsp;&nbsp;ä»ä¸Šé¢æœ€åä¸€è¡Œå¯ä»¥çœ‹å‡ºæ¥, æœ€åé€šè¿‡æ„é€ æ–¹æ³•è°ƒç”¨, è¿”å›äº†ä¸€ä¸ªçœŸå®çš„<code>ReactElement</code>, è¿™é‡Œå…¶å®å¯ä»¥çœ‹åšä¸€ä¸ªç±»å®ä¾‹æ„é€ ç±»ä¼¼ çœç•¥æ‰<code>new</code>æ“ä½œç¬¦çš„ç±»æ„é€ å™¨è°ƒç”¨.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ... è¿™ä¸ªmarkdownçš„æ”¯æŒå¯çœŸçƒ‚</span></span><br><span class="line"><span class="keyword">var</span> ReactElement = <span class="function"><span class="keyword">function</span>(<span class="params">type, key, ref, self, source, owner, props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    $$<span class="keyword">typeof</span>: REACT_ELEMENT_TYPE,</span><br><span class="line">    type,</span><br><span class="line">    key,</span><br><span class="line">    ref,</span><br><span class="line">    props,</span><br><span class="line">    _owner: owner</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>å±æ€§å</th><th>ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>$$typeof</td><td><code>Symbol</code></td><td>æ ‡è¯†è¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªReactElement</td></tr><tr><td>type</td><td><code>any</code></td><td>è¯¥Elementçš„ç±»å‹</td></tr><tr><td>key</td><td><code>string</code></td><td>æ ‡è¯†è¯¥èŠ‚ç‚¹çš„ç‹¬æœ‰key</td></tr><tr><td>ref</td><td><code>object</code> or <code>function</code></td><td>è¯¥èŠ‚ç‚¹å¯¹è±¡çš„å¼•ç”¨</td></tr><tr><td>props</td><td><code>object</code></td><td>è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§</td></tr><tr><td>_owner</td><td><code>any</code></td><td>æ ‡è¯†è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰è€…</td></tr></tbody></table><hr><h4 id="æœ€åçš„å°æµ‹è¯•"><a href="#æœ€åçš„å°æµ‹è¯•" class="headerlink" title="æœ€åçš„å°æµ‹è¯•:"></a>æœ€åçš„å°æµ‹è¯•:</h4><p>å°è¯•äººä¸ºè°ƒç”¨ä¸Šè¿°çš„<code>React.createElement</code>æ–¹æ³•æ¥å¾—åˆ°ä¸€ä¸ª<code>ReactElement</code>ç„¶åç”¨æ ‘å½¢ç»“æ„è¡¨ç¤ºå‡ºæ¥, ç­”æ¡ˆåœ¨ä¸‹ä¸€ç« å¼€å¤´.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sub"</span>&gt;</span>Text Node<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="ä¸‹æœŸé¢„å‘Š-ReactComponent"><a href="#ä¸‹æœŸé¢„å‘Š-ReactComponent" class="headerlink" title="ä¸‹æœŸé¢„å‘Š: ReactComponent"></a>ä¸‹æœŸé¢„å‘Š: ReactComponent</h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®è¯:&lt;/strong&gt; &lt;code&gt;ReactElement&lt;/code&gt; &lt;code&gt;JSX&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;ä¸€åˆ‡éƒ½è¦ä»ReactDOM-renderè®²èµ·&quot;&gt;&lt;a href=&quot;#ä¸€åˆ‡éƒ½è¦ä»ReactDOM-renderè®²èµ·&quot; class=&quot;headerlink&quot; title=&quot;ä¸€åˆ‡éƒ½è¦ä»ReactDOM.renderè®²èµ·&quot;&gt;&lt;/a&gt;ä¸€åˆ‡éƒ½è¦ä»ReactDOM.renderè®²èµ·&lt;/h3&gt;&lt;figure class=&quot;highlight jsx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; React &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; ReactDom &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react-dom&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Example &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;example&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ReactDOM.render(&amp;lt;Example/&amp;gt;, &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelector(&lt;span class=&quot;string&quot;&gt;&#39;#root&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ— - Â§1.1 ç”Ÿå‘½å‘¨æœŸ Life cycle</title>
    <link href="https://jeremywu.info/2018/07/17/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A71.1-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-Lifecycle/"/>
    <id>https://jeremywu.info/2018/07/17/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.1-ç”Ÿå‘½å‘¨æœŸ-Lifecycle/</id>
    <published>2018-07-17T13:25:22.000Z</published>
    <updated>2018-07-17T16:23:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®è¯:</strong> <code>Lifecycle</code> <code>ç”Ÿå‘½å‘¨æœŸ</code></p><h1 id="Reactçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Reactçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Reactçš„ç”Ÿå‘½å‘¨æœŸ"></a>Reactçš„ç”Ÿå‘½å‘¨æœŸ</h1><p>&emsp;&emsp;&nbsp;æ¯ä¸€ä¸ªè½¯ä»¶éƒ½æœ‰ä»–çš„ç”Ÿå‘½å‘¨æœŸ, Reactä¹Ÿä¸ä¾‹å¤–, ä»Reactçš„Tutorialå°±å¼€å§‹å‘æ¯ä¸€ä¸ªç”¨æˆ·ä»‹ç»Reactçš„ç”Ÿå‘½å‘¨æœŸ, Reactçš„å„ç§å†…åµŒé’©å­å‡½æ•°çš„ä½¿ç”¨. ä¸‹é¢æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹Reactçš„ç”Ÿå‘½å‘¨æœŸåˆ°åº•æœ‰å“ªå‡ ä¸ªè¿‡ç¨‹.</p><a id="more"></a><h3 id="é€šè¿‡ä¸€å¼ å›¾æ¥ç†è§£"><a href="#é€šè¿‡ä¸€å¼ å›¾æ¥ç†è§£" class="headerlink" title="é€šè¿‡ä¸€å¼ å›¾æ¥ç†è§£:"></a>é€šè¿‡ä¸€å¼ å›¾æ¥ç†è§£:</h3><img src="/2018/07/17/Reactæºç é˜…è¯»ç³»åˆ—-Â§1.1-ç”Ÿå‘½å‘¨æœŸ-Lifecycle/lifecycle.png" title="lifecycle"><h3 id="é€šè¿‡ä¸€æ®µæ³¨é‡Šæ¥ç†è§£"><a href="#é€šè¿‡ä¸€æ®µæ³¨é‡Šæ¥ç†è§£" class="headerlink" title="é€šè¿‡ä¸€æ®µæ³¨é‡Šæ¥ç†è§£:"></a>é€šè¿‡ä¸€æ®µæ³¨é‡Šæ¥ç†è§£:</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ------------------ The Life-Cycle of a Composite Component ------------------</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * - constructor: Initialization of state. The instance is now retained.</span></span><br><span class="line"><span class="comment"> *   - componentWillMount</span></span><br><span class="line"><span class="comment"> *   - render</span></span><br><span class="line"><span class="comment"> *   - [children's constructors]</span></span><br><span class="line"><span class="comment"> *     - [children's componentWillMount and render]</span></span><br><span class="line"><span class="comment"> *     - [children's componentDidMount]</span></span><br><span class="line"><span class="comment"> *     - componentDidMount</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       Update Phases:</span></span><br><span class="line"><span class="comment"> *       - componentWillReceiveProps (only called if parent updated)</span></span><br><span class="line"><span class="comment"> *       - shouldComponentUpdate</span></span><br><span class="line"><span class="comment"> *         - componentWillUpdate</span></span><br><span class="line"><span class="comment"> *           - render</span></span><br><span class="line"><span class="comment"> *           - [children's constructors or receive props phases]</span></span><br><span class="line"><span class="comment"> *         - componentDidUpdate</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     - componentWillUnmount</span></span><br><span class="line"><span class="comment"> *     - [children's componentWillUnmount]</span></span><br><span class="line"><span class="comment"> *   - [children destroyed]</span></span><br><span class="line"><span class="comment"> * - (destroyed): The instance is now blank, released by React and ready for GC.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * -----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><div class="tip"><br><p>æ³¨:</p><br><br><p>i. è¯¥æ³¨é‡Šå‡ºå¤„ä¸ºReact æºç ä»“åº“ä¸­çš„<a href="https://github.com/facebook/react/blob/v15.6.2/src/renderers/shared/stack/reconciler/ReactCompositeComponent.js#L88" target="_blank" rel="noopener">ReactCompositeComponent.js</a></p><br><p>ii. é€šè¿‡ç”¨æˆ·ç¼–å†™çš„<strong>Component</strong>éƒ½æ˜¯ä¸€ä¸ª<strong>Composite Component</strong></p><br></div><h3 id="ReactComponentç”Ÿå‘½å‘¨æœŸä»¥åŠæ‰€å¯¹åº”çš„é’©å­å‡½æ•°-Hook"><a href="#ReactComponentç”Ÿå‘½å‘¨æœŸä»¥åŠæ‰€å¯¹åº”çš„é’©å­å‡½æ•°-Hook" class="headerlink" title="ReactComponentç”Ÿå‘½å‘¨æœŸä»¥åŠæ‰€å¯¹åº”çš„é’©å­å‡½æ•°(Hook)"></a>ReactComponentç”Ÿå‘½å‘¨æœŸä»¥åŠæ‰€å¯¹åº”çš„é’©å­å‡½æ•°(Hook)</h3><ol><li><p>Component åˆ›å»º:<br>i. Component Constructor - åˆå§‹åŒ–State Props<br>ii. ComponentWillMount - Hook API<br>iii. render - åˆ›å»ºèŠ‚ç‚¹<br>iv. ComponentDidMount - Hook API</p></li><li><p>Component æ›´æ–°<br>i. ShouldComponentUpdate - Hook API<br>ii. ComponentWillUpdate - Hook API<br>iii. render - æ›´æ–°èŠ‚ç‚¹<br>iv. ComponentDidUpdate - Hook API</p></li><li><p>Component é”€æ¯<br>i. ComponentWillUnmount - Hook API<br>ii. ç±»ä¼¼ <code>someComponent = null;</code> - ç­‰å¾…GC</p></li></ol><h3 id="ä¸‹æœŸé¢„å‘Š-React-createElement"><a href="#ä¸‹æœŸé¢„å‘Š-React-createElement" class="headerlink" title="ä¸‹æœŸé¢„å‘Š: React.createElement"></a>ä¸‹æœŸé¢„å‘Š: <code>React.createElement</code></h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®è¯:&lt;/strong&gt; &lt;code&gt;Lifecycle&lt;/code&gt; &lt;code&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;Reactçš„ç”Ÿå‘½å‘¨æœŸ&quot;&gt;&lt;a href=&quot;#Reactçš„ç”Ÿå‘½å‘¨æœŸ&quot; class=&quot;headerlink&quot; title=&quot;Reactçš„ç”Ÿå‘½å‘¨æœŸ&quot;&gt;&lt;/a&gt;Reactçš„ç”Ÿå‘½å‘¨æœŸ&lt;/h1&gt;&lt;p&gt;&amp;emsp;&amp;emsp;&amp;nbsp;æ¯ä¸€ä¸ªè½¯ä»¶éƒ½æœ‰ä»–çš„ç”Ÿå‘½å‘¨æœŸ, Reactä¹Ÿä¸ä¾‹å¤–, ä»Reactçš„Tutorialå°±å¼€å§‹å‘æ¯ä¸€ä¸ªç”¨æˆ·ä»‹ç»Reactçš„ç”Ÿå‘½å‘¨æœŸ, Reactçš„å„ç§å†…åµŒé’©å­å‡½æ•°çš„ä½¿ç”¨. ä¸‹é¢æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹Reactçš„ç”Ÿå‘½å‘¨æœŸåˆ°åº•æœ‰å“ªå‡ ä¸ªè¿‡ç¨‹.&lt;/p&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Reactæºç é˜…è¯»ç³»åˆ— - Â§0 ç®€ä»‹ Intro</title>
    <link href="https://jeremywu.info/2018/07/16/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97-%C2%A70%20%E7%AE%80%E4%BB%8B%20Intro/"/>
    <id>https://jeremywu.info/2018/07/16/Reactæºç é˜…è¯»ç³»åˆ—-Â§0 ç®€ä»‹ Intro/</id>
    <published>2018-07-16T13:43:51.000Z</published>
    <updated>2018-07-22T14:02:23.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å…³é”®è¯:</strong> <code>React</code> <code>æºç åˆ†æ</code></p><h1 id="React-æºç é˜…è¯»"><a href="#React-æºç é˜…è¯»" class="headerlink" title="React æºç é˜…è¯»"></a>React æºç é˜…è¯»</h1><p><strong>&emsp;&emsp;&nbsp;æœ€è¿‘ç”±äºå·¥ä½œå˜åŠ¨, è¢«è°ƒåˆ°äº†æ–°çš„éƒ¨é—¨, æ–°çš„éƒ¨é—¨é‡Œçš„å¾ˆå¤šä»£ç å¹¶ä¸ç†Ÿæ‚‰, ä¾¿åªèƒ½ç¡¬ç€å¤´çš®çœ‹ä¸‹å», éšå³å‘ç°äº†ä¸€ä¸ªé—®é¢˜, è·³å‡ºèˆ’é€‚åœˆçš„æˆ‘, åœ¨çœ‹ä»£ç çš„è¿‡ç¨‹ä¸­, å­¦åˆ°äº†éå¸¸å¤šçš„ä¸œè¥¿, æƒ³è¦æƒ³åŠæ³•è¯æ˜è‡ªå·±, äºæ˜¯ä¾¿æƒ³å¼€è¿™ä¹ˆä¸€ç¯‡Reactçš„æºç é˜…è¯»çš„å‘, å‡†å¤‡èŠ±ä¸€æ®µæ—¶é—´æ¥é˜…è¯»ä»¥åŠè®°å½•è‡ªå·±å¯¹æºç é˜…è¯»åçš„ç†è§£å’Œæ„Ÿæ‚Ÿ.</strong></p><h3 id="Reactç‰ˆæœ¬"><a href="#Reactç‰ˆæœ¬" class="headerlink" title="Reactç‰ˆæœ¬"></a>Reactç‰ˆæœ¬</h3><div class="tip"><br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"Name"</span>: <span class="string">"React"</span>,</span><br><span class="line">  <span class="attr">"Version"</span>: <span class="string">"15.6.2"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br></div><a id="more"></a><h3 id="æ ¸å¿ƒæ¦‚å¿µ-Core-Concepts"><a href="#æ ¸å¿ƒæ¦‚å¿µ-Core-Concepts" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ (Core Concepts):"></a>æ ¸å¿ƒæ¦‚å¿µ (Core Concepts):</h3><p><strong>0. åŸºç¡€éƒ¨åˆ† (Pre-requirement)</strong></p><ul><li>ç”Ÿå‘½å‘¨æœŸ</li><li>ä» JSX (TSX) åˆ° JS</li></ul><p><strong>1. å¯åŠ¨éƒ¨åˆ† (åœ¨åº”ç”¨å¯åŠ¨æ—¶çš„ä»£ç åˆ†æ)</strong></p><ul><li>ä»ç»„ä»¶ (<strong>Component</strong>) åˆ° è™šæ‹ŸèŠ‚ç‚¹ (<strong>Virtual Node</strong>)</li><li>ä»è™šæ‹ŸèŠ‚ç‚¹ (<strong>Virtual Node</strong>) åˆ° çœŸå®DOMèŠ‚ç‚¹ (<strong>Actual Node</strong>)</li></ul><p><strong>2. å­˜åœ¨å‘¨æœŸ (åœ¨å­˜åœ¨å‘¨æœŸæ—¶çš„ä»£ç åˆ†æ)</strong></p><ul><li>äº‹ä»¶æœºåˆ¶ (Event Handling)</li><li>äº‹åŠ¡å¤„ç† (Transaction Operation)</li><li>æ›´æ–°æ“ä½œ (Updating Action)<br>i. æ•°æ®æ›´æ–° (Data Updating)<br>ii. è§†å›¾æ›´æ–° (Layout Updating)</li><li>ç»„ä»¶é—´çš„é€šä¿¡ (Component Communication)</li><li>Diffçš„ç®—æ³•åˆ†æ (Diff Algorithm)</li></ul><p><strong>3. æ€»ç»“</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;å…³é”®è¯:&lt;/strong&gt; &lt;code&gt;React&lt;/code&gt; &lt;code&gt;æºç åˆ†æ&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;React-æºç é˜…è¯»&quot;&gt;&lt;a href=&quot;#React-æºç é˜…è¯»&quot; class=&quot;headerlink&quot; title=&quot;React æºç é˜…è¯»&quot;&gt;&lt;/a&gt;React æºç é˜…è¯»&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;&amp;emsp;&amp;emsp;&amp;nbsp;æœ€è¿‘ç”±äºå·¥ä½œå˜åŠ¨, è¢«è°ƒåˆ°äº†æ–°çš„éƒ¨é—¨, æ–°çš„éƒ¨é—¨é‡Œçš„å¾ˆå¤šä»£ç å¹¶ä¸ç†Ÿæ‚‰, ä¾¿åªèƒ½ç¡¬ç€å¤´çš®çœ‹ä¸‹å», éšå³å‘ç°äº†ä¸€ä¸ªé—®é¢˜, è·³å‡ºèˆ’é€‚åœˆçš„æˆ‘, åœ¨çœ‹ä»£ç çš„è¿‡ç¨‹ä¸­, å­¦åˆ°äº†éå¸¸å¤šçš„ä¸œè¥¿, æƒ³è¦æƒ³åŠæ³•è¯æ˜è‡ªå·±, äºæ˜¯ä¾¿æƒ³å¼€è¿™ä¹ˆä¸€ç¯‡Reactçš„æºç é˜…è¯»çš„å‘, å‡†å¤‡èŠ±ä¸€æ®µæ—¶é—´æ¥é˜…è¯»ä»¥åŠè®°å½•è‡ªå·±å¯¹æºç é˜…è¯»åçš„ç†è§£å’Œæ„Ÿæ‚Ÿ.&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;Reactç‰ˆæœ¬&quot;&gt;&lt;a href=&quot;#Reactç‰ˆæœ¬&quot; class=&quot;headerlink&quot; title=&quot;Reactç‰ˆæœ¬&quot;&gt;&lt;/a&gt;Reactç‰ˆæœ¬&lt;/h3&gt;&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;Name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;React&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;Version&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;15.6.2&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Reactæºç é˜…è¯»ç³»åˆ—" scheme="https://jeremywu.info/categories/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Reactæºç é˜…è¯»" scheme="https://jeremywu.info/tags/React%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
</feed>
